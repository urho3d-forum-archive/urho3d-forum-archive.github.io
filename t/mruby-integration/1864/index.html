<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Mruby integration</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Mruby integration</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">will</div>
          <div class="post_content">
<p>Hi, i’m new to CMake. I don’t know how to integrate mruby source into urho3d make system.<br/>
mruby source is unzipped into <code>Urho3D/Source/ThirdParty/MRuby/mruby-1.2.0</code><br/>
And CMakeLists.txt is as following, which is copied from Lua folder<br/>
But i don’t know what is going on under the hood<br/>
Can anybody help me ?</p>
<pre><code class="lang-auto">set (TARGET_NAME MRuby)
set (MRUBY_VERSION mruby-1.2.0)
set (MRUBY_DIR ${CMAKE_CURRENT_SOURCE_DIR}/${MRUBY_VERSION})
#set (MRUBY_LIBRARY ${MRUBY_DIR}/build/host/lib/libmruby.a)
#set (MRUBY_CORE_LIBRARY ${MRUBY_DIR}/build/host/lib/libmruby_core.a)

# define_source_files ()
setup_library ()

# Install headers for building and using the Urho3D library (no direct dependencies but library user may need them)
install_header_files (DIRECTORY ${MRUBY_DIR}/include/ DESTINATION ${DEST_INCLUDE_DIR}/ThirdParty/MRuby FILES_MATCHING PATTERN *.h)  # Note: the trailing slash is significant</code></pre>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>Welcome to our forum.</p>
<p>Have you tried to build mruby using its own build system before trying to integrate it with Urho3D build system? If the mruby own build system is also CMake based then it should be easier to do this integration, or otherwise you will have to adapt whatever build configuration file used by mruby into a new CMakeList.txt. Simply copying and replacing the stuff out from existing CMakeLists.txt from Lua and hope for the best, would probably not work. At the very least you need to first learn the CMake basic and then move on to study how to use our Urho3D own convenient macros. The macros that you posted below would only work as expected when you have also initialized the necessary CMake variables. If what you posted is the complete CMakeLists.txt then obviously you have missed out the initialization for the SOURCE_FILES CMake variable. But, I think we have already getting ahead of ourselves.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">will</div>
          <div class="post_content">
<p>Thanks for replying.<br/>
mruby’s make system is based on Rakefile, i can build mruby using its own make system.<br/>
I’ve searched all URHO3D_ANGELSCRIPT in CMakeLists.txt and add similar URHO3D_MRUBY there.<br/>
I am trying to write a CMake version of Rakefile. I also have another idea whether i can directly use the prebuilt version of libmruby.a<br/>
Well, I will try.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>