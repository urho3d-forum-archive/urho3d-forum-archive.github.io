<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>[SOLVED] Multi-texture models</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">[SOLVED] Multi-texture models</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">sandsound</div>
          <div class="post_content">
<p>Sorry if this have been answered elsewhere, but I haven’t been able to find any examples of using multiple textures on a model, is this at all possible?</p>
<p>I wanted to use one of the Mixamo-models (Erika-archer) for my game, but are having a lot of problems. One of them is that her body apparently uses another texture than her clothes.</p>
<p>Would be awesome if someone had the model game-ready for download, but I’d also be happy if someone could just point me in the right direction.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2384_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Leith</div>
          <div class="post_content">
<p>Yes it is possible. Models can have multiple materials and meshes, and each mesh can use a different material.<br/>
You can make a car with four wheels that use a rubber tyre material, and not need four wheel meshes, as well.<br/>
The windscreen and other windows can be made of another material, this is fine, within a single model.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">sandsound</div>
          <div class="post_content">
<p>Do you know of any examples of this?<br/>
just a basic one would be great since I have a hard time learning something without seeing it in action.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2369_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Dave82</div>
          <div class="post_content">
<p>You can set a material per geometry by calling animatedModel-&gt;SetMaterial(geometryId , material);<br/>
The number of geometries can be checked by calling model-&gt;GetNumGeometries();</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>If you create a ModelName.txt file in the same directory as the model you can call <code>ApplyMaterialList()</code> on the model component. This file would simply contain a list of the names of the materials.</p>
<pre><code class="lang-auto">Materials/Mat0.xml
Materials/Mat1.xml
Materials/Mat2.xml
</code></pre>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">I3DB</div>
          <div class="post_content">
<p>How about for this <a href="https://github.com/xamarin/urho-samples/blob/master/FeatureSamples/Assets/Data/Models/Jack.mdl" rel="nofollow noopener">model for Jack</a>?</p>
<p>I’ve been trying to get <a href="https://github.com/xamarin/urho-samples/blob/master/FeatureSamples/Assets/Data/Models/Jack.mdl" rel="nofollow noopener">the Jack.mdl model here</a> to use the face and body textures.</p>
<p>It <a href="https://github.com/xamarin/urho-samples/blob/master/FeatureSamples/Assets/Data/Materials/Jack.xml" rel="nofollow noopener">has an associated material</a>, but it’s been edited to use no texture.</p>
<p>However, there are two textures, <a href="https://github.com/xamarin/urho-samples/blob/master/FeatureSamples/Assets/Data/Textures/Jack_body_color.jpg" rel="nofollow noopener">here</a> and <a href="https://github.com/xamarin/urho-samples/blob/master/FeatureSamples/Assets/Data/Textures/Jack_face.jpg" rel="nofollow noopener">here</a> that seem like the right ones.</p>
<p>How would the Material/Jack file need to be edited to include those two textures for this one model?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">sandsound</div>
          <div class="post_content">
<p>Thanks for all the tips, I think I have an idea of how to do this now.</p>
<p>It would still be nice if there was an example in the samples, perhaps just a change in one of the existing samples?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2369_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Dave82</div>
          <div class="post_content">
<aside class="quote no-group" data-post="6" data-topic="4832" data-username="I3DB">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/08ac2a702e042b87fc3e2def689b323c.png" width="20"/> I3DB:</div>
<blockquote>
<p>How about for this <a href="https://github.com/xamarin/urho-samples/blob/master/FeatureSamples/Assets/Data/Models/Jack.mdl" rel="noopener nofollow ugc">model for Jack</a>?</p>
</blockquote>
</aside>
<p>Create two materials JackBody.xml and JackHead.xml set technique , and diffuse texture unit to your corresponding texture files. And finally create a Jack.txt file and set to point to your materials.(as Modanung suggested)</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">I3DB</div>
          <div class="post_content">
<p><span class="mention">@Dave82</span></p>
<ol>
<li>Created the two files, JackBody/JackHead.xml in materials folder.</li>
<li>Copied the existing Jack.xml contents to each, and modified the texture of each</li>
<li>Created the Jack.txt file where Jack.mdl exists and added paths to the jack materials.</li>
<li>Made code change to ApplyMaterialList and removed to previous call to setmaterial to jack.xml.</li>
</ol>
<p>Tested … couldn’t find Materials/JackHead.xml</p>
<pre><code class="lang-auto">ERROR: Could not find resource ﻿Materials/JackHead.xml
</code></pre>
<p>Tried putting in path in Jack.txt as  …/Materials/JackHead.xml … same error.<br/>
Created a new folder Materials inside the models folder and put materials there … same error.<br/>
Put materials in models folder as same level as Jack.mdl and edited paths in Jack.txt to just file names …  same error.</p>
<p>If I load the JackHead.xml material just by itself or JackBody.xml, both load fine.</p>
<p>If I set the material directly using either the head or body, nothing paints but default material, but no error messages.</p>
<pre><code class="lang-auto">modelObject.Material = Application.ResourceCache.GetMaterial("Materials/JackBody.xml");
</code></pre>
<p>But this will give Jack a colored body:</p>
<pre><code class="lang-auto">modelObject.Material = Material.FromColor(Randoms.NextColor());
</code></pre>
<p>Seems simple enough, what am I missing?</p>
<p>Here is the JackHead.xml file after edit:</p>
<pre><code class="lang-auto">&lt;material&gt;
  &lt;technique name="Techniques/NoTexture.xml" /&gt;
  &lt;parameter name="MatSpecColor" value="0.5 0.5 0.5 16" /&gt;
  &lt;texture unit="diffuse" name="Materials/Jack_face.jpg" /&gt;
&lt;/material&gt;
</code></pre>
<p>And the Jack.txt file contents:</p>
<pre><code class="lang-auto">JackHead.xml
JackBody.xml
</code></pre>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">I3DB</div>
          <div class="post_content">
<p>As <span class="mention">@sandsound</span> pointed out, a working sample really is useful. When I try this simple case, the error messages aren’t helpful enough to figure out the problem.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<aside class="quote no-group quote-modified" data-post="9" data-topic="4832" data-username="I3DB">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/08ac2a702e042b87fc3e2def689b323c.png" width="20"/> I3DB:</div>
<blockquote>
<p>&lt;technique name=“Techniques/<strong>NoTexture</strong>.xml” /&gt;<br/>
&lt;<strong>texture</strong> unit=“diffuse” name=“Materials/Jack_face.jpg” /&gt;</p>
</blockquote>
</aside>
<p>The <code>NoTexture</code> technique does not support textures.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">I3DB</div>
          <div class="post_content">
<aside class="quote no-group quote-modified" data-post="11" data-topic="4832">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/77cf83d04c1ba40d49ef5e2eb805a0ac.png" width="20"/> Modanung:</div>
<blockquote>
<blockquote>
<p>&lt;technique name=“Techniques/ <strong>NoTexture</strong> .xml” /&gt;<br/>
&lt; <strong>texture</strong> unit=“diffuse” name=“Materials/Jack_face.jpg” /&gt;</p>
</blockquote>
<p>The <code>NoTexture</code> technique does not support textures.</p>
</blockquote>
</aside>
<p>And … is there a technique which does? Could you give a clue?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<aside class="quote no-group" data-post="12" data-topic="4832" data-username="I3DB">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/08ac2a702e042b87fc3e2def689b323c.png" width="20"/> I3DB:</div>
<blockquote>
<p>And … is there a technique which does? Could you give a clue?</p>
</blockquote>
</aside>
<p>Any technique with the word <code>Diff</code>, depending on your final goal.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">I3DB</div>
          <div class="post_content">
<p>I’d really just like to see a working example where more than one material is added to one model.</p>
<p>That is my goal.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<p>I’m not 100% sure for Urho#, but there shall be someting like <code>Materials</code>, or some other plural property or function to setup materials for model. Or use text file, but all resource names still have to be “absolute” (relative to base resource folders)</p>
<aside class="quote no-group" data-post="9" data-topic="4832" data-username="I3DB">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/08ac2a702e042b87fc3e2def689b323c.png" width="20"/> I3DB:</div>
<blockquote>
<p>And the Jack.txt file contents:</p>
<pre><code class="lang-auto">JackHead.xml
JackBody.xml
</code></pre>
</blockquote>
</aside>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">I3DB</div>
          <div class="post_content">
<p>I got it working, but it’s not working …</p>
<pre><code class="lang-auto">modelObject.ApplyMaterialList();
modelObject.Material = Application.ResourceCache.GetMaterial("Materials/JackBody.xml");
</code></pre>
<p>ApplyMaterialList() throws this error::</p>
<pre><code class="lang-auto">ERROR: Could not find resource ﻿Materials/JackBody.xml
</code></pre>
<p>But does paint Jack’s head.<br/>
The next line paints Jack’s body. No problems finding the material I guess.</p>
<p>JackHead.xml contents</p>
<pre><code class="lang-auto">&lt;material&gt;
  &lt;technique name="Techniques/Diff.xml" /&gt;
  &lt;parameter name="MatSpecColor" value="0.5 0.5 0.5 16" /&gt;
  &lt;texture unit="diffuse" name="Jack_face.jpg" /&gt;
&lt;/material&gt;
</code></pre>
<p>JackBody.xml contents</p>
<pre><code class="lang-auto">&lt;material&gt;
  &lt;technique name="Techniques/Diff.xml" /&gt;
  &lt;parameter name="MatSpecColor" value="0.5 0.5 0.5 16" /&gt;
  &lt;texture unit="diffuse" name="Jack_body_color.jpg" /&gt;
&lt;/material&gt;
</code></pre>
<p>Jack.txt contents</p>
<pre><code class="lang-auto">Materials/JackBody.xml
Materials/JackHead.xml
</code></pre>
<p>If the two lines are swapped in Jack.txt, then Jack’s head gets the body material.<br/>
modelObject.Material = always sets the body’s material, never the head.</p>
<p>Also, changing the path on texture of either file, for instance to:</p>
<pre><code class="lang-auto">  &lt;texture unit="diffuse" name="Textures/Jack_body_color.jpg" /&gt;
</code></pre>
<p>makes no difference. There is a single Jack_body_color.jpg and setting material directly finds it regardless of the path set differently, and has no effect on the errors thrown by ApplyMaterialList().</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">I3DB</div>
          <div class="post_content">
<p>The issue is whichever resource is listed first in Jack.txt is never found. If it’s the second line, it works fine.</p>
<p>Created the file in visual studio by adding a new file. Edited the contents also in visual studio. Probably something to do with encoding or line endings.</p>
<p>But there is a workaround, and this is then to set the material using whatever was on the first line of the .txt file. That setting overrides the first line of the .txt, which isn’t set due to some issue reading the file.</p>
<p>Tried adding a space and a blank line to that first line. If a blank first line, both of the resources are found, but the body will be default material. In fact, no matter what I did with the Jack.txt file, never could get the body to paint through using ApplyMaterialsList(). This very well could be due to something in the SharpReality binding, or a bug in the reading of the .txt file contents in Urho.dll.</p>
<p>Finally, also tried <span class="mention">@Dave82</span> 's suggestion for .SetMaterial, though in my exerience, the sharpreality binding tends to throw a lot of exceptions with .SetMaterial, so I don’t like to use it.</p>
<p>But, this works with no exceptions or errors noted in my case:</p>
<pre><code class="lang-auto">modelObject.SetMaterial(0, Application.ResourceCache.GetMaterial("Materials/JackBody.xml"));
modelObject.SetMaterial(1, Application.ResourceCache.GetMaterial("Materials/JackHead.xml"));
</code></pre>
<p>And if creating a lot of models, for instance for the skeletal animation model, there the errors add quite a bit of delay lessening the user experience.</p>
<p>Also, <span class="mention">@Egorbo</span> could have made a Materials field rather than a Material field. That’s a purely SharpReality issue though, unrelated.</p>
<pre><code class="lang-auto">namespace Urho
{
	partial class StaticModel
	{
		public Material Material
		{
			get { return GetMaterial(0); }
			set { SetMaterial(0, value); }
		}
	}

	partial class AnimatedModel
	{
		public Model Model
		{
			get { return base.Model; }
			set { this.SetModel(value, true); }
		}
	}
}
</code></pre>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">sandsound</div>
          <div class="post_content">
<aside class="quote no-group" data-post="17" data-topic="4832" data-username="I3DB">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/08ac2a702e042b87fc3e2def689b323c.png" width="20"/> I3DB:</div>
<blockquote>
<p>Created the file in visual studio by adding a new file. Edited the contents also in visual studio. Probably something to do with encoding or line endings.</p>
</blockquote>
</aside>
<p>I remember having similar problems with Borlands Delphi back in the day, that’s why I use a simple text-editor today.</p>
<p>Regarding an example, I threw something together, but haven’t found a place to host it yet, besides… I’m almost certain that one of the actual devs can make something better <img alt=":slight_smile:" class="emoji" src="../../../images2/480f97b912eb537e18032299081e582a.png" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2384_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Leith</div>
          <div class="post_content">
<p>Ugh line endings!</p>
<p>I’m fairly new to Linux - porting my old Windows code to Linux is painful enough without having to deal with line endings.<br/>
I feel for you.</p>
<p>Surely we can find a common encoding that just works? Sigh.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<aside class="quote no-group" data-post="19" data-topic="4832" data-username="Leith">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/344277caf39f87861709d8bd9d77ec6d.png" width="20"/> Leith:</div>
<blockquote>
<p>Surely we can find a common encoding that just works? Sigh.</p>
</blockquote>
</aside>
<p>We did, Microsoft is just keeping up a tradition of ignoring standards.</p>
<p>Best ignore <em>that</em> for the sake of sanity. <img alt=":wink:" class="emoji" src="../../../images2/58bcd684421190f24be1944e2a997a04.png" title=":wink:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">I3DB</div>
          <div class="post_content">
<p>Ran this on a different platform with the file, and the error message is:</p>
<pre><code class="lang-auto">Could not find resource ï»¿Materials/JackBody.xml. 
</code></pre>
<p>Then recreated the file Jack.txt with vscode and all works perfectly.</p>
<p>modelObject.ApplyMaterialList(); worked fine.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">sandsound</div>
          <div class="post_content">
<p><span class="mention">@I3DB</span><br/>
You should be able to disable <a href="https://en.wikipedia.org/wiki/Byte_order_mark" rel="nofollow noopener">BOM</a> in your editor</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">I3DB</div>
          <div class="post_content">
<aside class="quote no-group" data-post="22" data-topic="4832" data-username="sandsound">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/145037338f2ee241b894d785b74e222d.png" width="20"/> sandsound:</div>
<blockquote>
<p>You should be able to disable <a href="https://en.wikipedia.org/wiki/Byte_order_mark" rel="noopener nofollow ugc">BOM </a> in your editor</p>
</blockquote>
</aside>
<p>Found this <a class="inline-onebox" href="https://vlasovstudio.com/fix-file-encoding/" rel="noopener nofollow ugc">Fix File Encoding - Prevent Visual Studio from adding BOM to UTF-8 files - Vlasov Studio (Best in class Visual Studio extensions and tools)</a></p>
<p>But didn’t see a way to do it directly in options in VS, but that’s why vscode is handy.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>2 posts were split to a new topic: <a href="/t/problem-applying-textures-to-jack/5645">Problem applying textures to Jack</a></p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>