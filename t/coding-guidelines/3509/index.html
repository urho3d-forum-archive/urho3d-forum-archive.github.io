<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Coding Guidelines</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Coding Guidelines</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/81_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Enhex</div>
          <div class="post_content">
<p><strong>TL;DR:</strong> Choose official coding guideline to shut down wasteful pointless arguments.</p>
<p>While Urho3D have coding style guidelines (stuff like naming &amp; indentation), it doesn’t have coding guidelines.</p>
<p>Considering arguments <a  rel="nofollow noopener">block PRs</a>, and since <span class="mention">@cadaver</span> left, I think it’s important to have agreed upon official guidelines so we can point <a href="https://en.wiktionary.org/wiki/bikeshedding" rel="nofollow noopener">bikeshedders</a> to them to shut down the argument, so they won’t waste time and block progress.</p>
<p>Since it’s pointless to try to argue with “Poisonous People”<sup>[1]</sup>, because:</p>
<ul>
<li>They don’t listen</li>
<li>They just want to keep arguing forever</li>
</ul>
<p>I’m in favor of using <a href="https://github.com/isocpp/CppCoreGuidelines" rel="nofollow noopener">C++ Core Guidelines</a>, and here are the reasons:</p>
<ul>
<li>It’s written and reviewed by a lot of people, including experts like C++ committee members.</li>
<li>It addresses a lot of topics - less opportunities for arguments.</li>
<li>At least with Visual Studio, there’s static analysis checker for the Core Guidelines.</li>
<li>It’s designed for modern C++</li>
</ul>
<p>Note that the goal of using a coding guideline (at least for me) is not to fanatically follow it, but to shut down wasteful arguments by already having official rules in place.</p>
<p>1 - Poisonous People:</p>
<div class="lazyYT" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque" data-width="480" data-youtube-id="-F-3E8pyjFo" data-youtube-title="Google I/O 2008 - Open Source Projects and Poisonous People"></div>
<p>Please vote:</p>
<div class="poll" data-poll-name="poll" data-poll-public="true" data-poll-status="open" data-poll-type="regular">
<div>
<div class="poll-container">
<ul>
<li data-poll-option-id="2398d266aecac03549fc81c33841743c">Let’s use C++ Core Guidelines</li>
<li data-poll-option-id="5f95e8b4d3a3dfb794a9720f177d45cb">Let’s use some other guideline (please explain which and why)</li>
<li data-poll-option-id="1937e4f539b45c94c527a32bf7115c4a">I’m against using guidelines</li>
</ul>
</div>
<div class="poll-info">
<p>
<span class="info-number">0</span>
<span class="info-text">voters</span>
</p>
</div>
</div>
<div class="poll-buttons">
<a title="Display the poll results">Show results</a>
</div>
</div>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<p>My answer is 2. Detailed <em>opinion</em> is below.</p>
<p>C++ Core Guidelines pros:</p>
<ul>
<li>Reasonable guideline designed by many clever people;</li>
<li>Already written;</li>
</ul>
<p>Cons:</p>
<ul>
<li>Hard to check code conformity. All contributors literally have to read and re-read 100-pages paper.</li>
<li><strong>The guideline interferes with Urho legacy code;</strong></li>
</ul>
<p>The last item is most important here.</p>
<p>If there is a conflict between contribution and legacy, it must be resolved before merge. This rule is obvious for code contributions.</p>
<p>I don’t think that <em>code standard</em> contribution is too different from code. If you introduce code standard changes that interfere with legacy code, you should resolve the conflict.</p>
<p>My recent actions is a kind of example.</p>
<ol>
<li>I <em>committed</em> three strict rules into code standard (override is required, typedef is forbidden, 0 and NULL pointer constants are forbidden)</li>
<li>There become a conflict;</li>
<li>I resolved the conflict. Urho master branch is fully conformant with newly committed coding conventions;</li>
</ol>
<p>Some new C++11 features doesn’t replace old counterparts. <code>{}</code>-ctor cannot completely replace <code>()</code>-ctor, <code>auto</code> cannot completely replace explicit type, inplace member initalization cannot completely replace initializer lists, range-based <code>for</code> cannot completely replace index-based <code>for</code> and so on.</p>
<p>I also committed some <em>weak</em> rules related to these features. These rules are not requirements but suggestions. Such rules doesn’t interfere with legacy code due to their weak nature.</p>
<p><strong>C++ Core Guidelines are in the conflict with Urho code, so they couldn’t be commited until the conflicts are resolved either on the guidelines or on the code side.</strong></p>
<p>If the project’s code doesn’t meet the project’s codestyle, it is equal to the absence of the codestyle.<br/>
So, “Let’s use C++ Core Guidelines” is equal to “Let’s drop codestyle requirements”.<br/>
I couldn’t vote for such item, with all due respect to C++ Core Guidelines itself (no sarcasm)</p>
<hr/>
<p>Wow, I almost forget about an answer. We should use guidelines that are not in the conflict with Urho legacy.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/81_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Enhex</div>
          <div class="post_content">
<aside class="quote no-group" data-post="2" data-topic="3509" data-username="Eugene">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/ae663b3d37eca5ee603f9e0610f8f829.png" width="20"/> Eugene:</div>
<blockquote>
<p>Hard to check code conformity. All contributors literally have to read and re-read 100-pages paper.</p>
</blockquote>
</aside>
<p>You literally have <a href="https://blogs.msdn.microsoft.com/vcblog/2017/08/11/c-core-guidelines-checker-in-visual-studio-2017/" rel="noopener nofollow ugc">static analysis tool that automatically do it</a> (didn’t you read what I wrote?). Also you don’t have to read it all, it’s very organized and broken into categories and short points on each topic.</p>
<aside class="quote no-group" data-post="2" data-topic="3509" data-username="Eugene">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/ae663b3d37eca5ee603f9e0610f8f829.png" width="20"/> Eugene:</div>
<blockquote>
<p>The guideline interferes with Urho legacy code;</p>
</blockquote>
</aside>
<p>Doesn’t matter. There’s absolutely 0 need to go back and upgrade all existing code.<br/>
Just apply it to new code.<br/>
Your “conflict” is a non-issue.</p>
<p>There’s no need to fanatically follow a guideline.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>I can not block anything, since I do not have the authority, I can only express my point of view.<br/>
Poisonous People? Ok. Everyone whose opinion does not match yours is a “toxic person”. It turns out from my point of view that you. Just answer the question whether your PR code is more understandable. Why do we need PR, which makes the code less understandable?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<aside class="quote" data-post="3" data-topic="3509">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/2a544a080a692659db243ae9ac8c57ef.png" width="20"/> Enhex:</div>
<blockquote>
<p>You literally have static analysis tool that automatically do it (didn’t you read what I wrote?). Also you don’t have to read it all, it’s very organized and broken into categories and short points on each topic.</p>
</blockquote>
</aside>
<p>This is not a problem for me. Try to convince remaining 100 contibuitors to check their code. They sometimes don’t even follow indentation rules… /_-</p>
<p>BTW, some people don’t use Visual Studio.</p>
<aside class="quote" data-post="3" data-topic="3509">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/2a544a080a692659db243ae9ac8c57ef.png" width="20"/> Enhex:</div>
<blockquote>
<p>Doesn’t matter. There’s absolutely 0 need to go back and upgrade all existing code.</p>
<p>Just apply it to new code.</p>
<p>Your “conflict” is a non-issue.</p>
<p>There’s no need to fanatically follow a guideline.</p>
</blockquote>
</aside>
<p>It’s highly depends on guideline items. I agree that we could follow many of them, but definetely not all. So, the 1st item in the vote is just unrealistic. We will have to tune C++ Core Guidelines anyway.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">HplusDiese</div>
          <div class="post_content">
<p>What about UE4 code style?<br/>
It looks like my code style, but with some refinements. I use it in my personal project.<br/>
<aside class="onebox whitelistedgeneric">
<header class="source">
<img class="site-icon" height="" src="../../../images2/db22795676f9a6ff0638bc772f920c62.png" width=""/>
<a href="https://docs.unrealengine.com/latest/INT/Programming/Development/CodingStandard/" rel="nofollow noopener" target="_blank">docs.unrealengine.com</a>
</header>
<article class="onebox-body">
<h3><a href="https://docs.unrealengine.com/latest/INT/Programming/Development/CodingStandard/" rel="nofollow noopener" target="_blank">Coding Standard</a></h3>
<p>Standards and conventions used by Epic Games in the Unreal Engine 4 codebase.</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/81_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Enhex</div>
          <div class="post_content">
<p>You block it in the sense you create an argument over a tiny detail you personally don’t like.</p>
<p>Regarding “Poisonous People” just watch the talk. The term sounds nasty but in short it just means redirecting peoples time and energy to pointless stuff and thus stalling progress.</p>
<aside class="quote no-group" data-post="5" data-topic="3509" data-username="Eugene">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/ae663b3d37eca5ee603f9e0610f8f829.png" width="20"/> Eugene:</div>
<blockquote>
<p>Try to convince remaining 100 contibuitors to check their code.</p>
</blockquote>
</aside>
<p>You don’t need to. You’re not listening.<br/>
I wrote in the previous reply you don’t need to go back and upgrade everything.</p>
<aside class="quote no-group" data-post="5" data-topic="3509" data-username="Eugene">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/ae663b3d37eca5ee603f9e0610f8f829.png" width="20"/> Eugene:</div>
<blockquote>
<ol>
<li>I agree that we could follow many of them, but definetely not all.</li>
<li>So, the 1st item in the vote is just unrealistic.</li>
<li>We will have to tune C++ Core Guidelines anyway.</li>
</ol>
</blockquote>
</aside>
<ol>
<li>That’s only your opinion.</li>
<li>It’s more realistic than you writing your own guidelines that no one else agreed upon.</li>
<li>Why? Because there are things you personally don’t like?</li>
</ol>
<aside class="quote no-group" data-post="5" data-topic="3509" data-username="Eugene">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/ae663b3d37eca5ee603f9e0610f8f829.png" width="20"/> Eugene:</div>
<blockquote>
<p>some people don’t use Visual Studio.</p>
</blockquote>
</aside>
<p>It’s enough that 1 contributor does. He can run it once in a while, find and fix problems, and submit fixes.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>“pointless stuff” is rewriting exiting and working code</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>In any case, when you plan to add new cool features to Urho?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<aside class="quote" data-post="7" data-topic="3509">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/2a544a080a692659db243ae9ac8c57ef.png" width="20"/> Enhex:</div>
<blockquote>
<p>You don’t need to. You’re not listening.</p>
<p>I wrote in the previous reply you don’t need to go back and upgrade everything.</p>
</blockquote>
</aside>
<p>I am. I meant that it may be harder to enforce people follow the rules when they make PRs.</p>
<blockquote>
<p>It’s more realistic than you writing your own guidelines that no one else agreed upon.</p>
</blockquote>
<p>I don’t suggest this.</p>
<blockquote>
<p>That’s only your opinion.<br/>
Why? Because there are things you personally don’t like?</p>
</blockquote>
<p>My personal tastes doesn’t matter here. Personally I <em>do</em> like e.g. standard containers and leading-comma initializer lists, but I don’t push them to Urho out of respect for legacy.</p>
<p>The main and the only mission of the code standard is to keep code consistent by enforcing rules. If code doesn’t meet the code standard, this standard is a pointless bullshut.</p>
<p>I’ll revise Core Guidelines and list concrete ‘bad’ items to be less unfounded.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/81_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Enhex</div>
          <div class="post_content">
<p>It’s very basic.<br/>
It seems to be mostly about formatting style choices. Urho3D already has style guideline.<br/>
(personally I don’t care much about if u break line before braces and other such style decisions).<br/>
It also had good non-style advice.<br/>
And some things I don’t want such as Hungarian Notation for some classes. It only increases maintenance and has no value (already saw code that had wrong types embedded in names).</p>
<p>Also it isn’t as complete as C++ Core Guidelines, which leaves more room for arguments.</p>
<aside class="quote no-group" data-post="10" data-topic="3509" data-username="Eugene">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/ae663b3d37eca5ee603f9e0610f8f829.png" width="20"/> Eugene:</div>
<blockquote>
<p>but I don’t push them to Urho out of respect for legacy.</p>
</blockquote>
</aside>
<p>Again, there’s no need to upgrade existing code. New code can be written in better ways. Things should compile just fine.</p>
<aside class="quote no-group" data-post="10" data-topic="3509" data-username="Eugene">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/ae663b3d37eca5ee603f9e0610f8f829.png" width="20"/> Eugene:</div>
<blockquote>
<p>The main and the only mission of the code standard is to keep code consistent by enforcing rules. If code doesn’t meet the code standard, this standard is a pointless bullshut.</p>
</blockquote>
</aside>
<p>If the goal of a code standard is to follow a code standard, what’s the point?<br/>
It doesn’t solve any problems.</p>
<p>If the goal of a code standard is to prevent errors/bugs, improve readability, improve correctness, resolve arguments, and so on, it doesn’t matter if 100% of your code follows it or not, since more is always better.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<blockquote>
<p>Again, there’s no need to upgrade existing code. New code can be written in better ways. Things should compile just fine.</p>
</blockquote>
<p>I agree with you <em>with exceptions</em>, that’s the point.</p>
<blockquote>
<p>it doesn’t matter if 100% of your code follows it or not, since more is always better.</p>
</blockquote>
<p>I have a dirty analogy for you.</p>
<blockquote>
<p>“Helicopter is better than car. So I added some blades on top of my car. It’s not 100% helicopter, but more is always better.”</p>
</blockquote>
<hr/>
<p>Here is the list of items that I don’t want to be in the Urho. This is quite small subset of C++ Core Guidelines, isn’t it?</p>
<h3>Block</h3>
<p>ES.107: Don’t use unsigned for subscripts<br/>
C.133: Avoid protected data</p>
<h3>Block or perform API-breaking refactoring:</h3>
<p>Enum.3: Prefer class enums over “plain” enums<br/>
Enum.5: Don’t use ALL_CAPS for enumerators</p>
<h3>Block or perform refactoring</h3>
<p>C.128: Virtual functions should specify exactly one of virtual, override, or final</p>
<h3>Block or use EASTL</h3>
<p>ES.1: Prefer the standard library to other libraries and to "handcrafted code"<br/>
ES.27: Use std::array or stack_array for arrays on the stack</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/81_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Enhex</div>
          <div class="post_content">
<p>I agree with you against:<br/>
ES.107: Don’t use unsigned for subscripts -<br/>
use what the container’s size type. The claim about performance needs to be proved.</p>
<p>C.133: Avoid protected data</p>
<p>I disagree with you against (not saying we should use them, just that they’re not wrong):<br/>
Enum.3: Prefer class enums over “plain” enums -<br/>
prefer only. They’re hard to use for indexing anyway so they’re aren’t the default choice. I’m not sure if they work with AngelScript too.</p>
<p>Enum.5: Don’t use ALL_CAPS for enumerators -<br/>
just easier to read non-all caps.</p>
<p>C.128: Virtual functions should specify exactly one of virtual, override, or final -<br/>
override is implicitly virtual. mixing final with the others doesnt make sense</p>
<p>ES.1: Prefer the standard library to other libraries and to “handcrafted code” -<br/>
<a href="https://discourse.urho3d.io/t/urho-vs-stdlib-small-benchmark-vs2015/1225">standard STL is actually faster than Urho’s in some cases</a>. Need to benchmark EASTL against STL/Urho. Using STL is easier. An argument against std STL is that different compilers got different implementations which can lead to inconsistency.</p>
<p>ES.27: Use std::array or stack_array for arrays on the stack -<br/>
std::array is more convenient than C array.</p>
<p>There’s no need to 100% follow everything in it.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<blockquote>
<p>use what the container’s size type</p>
</blockquote>
<p>Exactly.</p>
<blockquote>
<p>I disagree with you against (not saying we should use them, just that they’re not wrong)</p>
</blockquote>
<p>I didn’t completely understand you, elaborate, please.</p>
<blockquote>
<p>prefer only. They’re hard to use for indexing anyway so they’re aren’t the default choice.</p>
</blockquote>
<p><code>enum class</code>es will bring inconsistency into Urho public interface. Inconsistent public interface is a bullshit. So I am against using <code>enum class</code> at all in the entire Urho3D Core. Let’s leave them for community modules.</p>
<blockquote>
<p>just easier to read non-all caps</p>
</blockquote>
<p>Agree. But: see above.</p>
<blockquote>
<p>override is implicitly virtual. mixing final with the others doesnt make sense</p>
</blockquote>
<p>I know &gt;5 people who prefer to always keep virtual, but it’s just personal taste.<br/>
The more important thing is that inconsistency here is misleading and confusing for readers.<br/>
Before following this rule in new code all redundand virtuals shall be removed. It’s not so hard, actually.</p>
<blockquote>
<p>Using STL is easier. An argument against std STL is that different compilers got different implementations which can lead to inconsistency.</p>
</blockquote>
<p>STL may be slower in debug mode. Moreover, we still shall not use neither STL nor EASTL in public API because Urho already uses its own containers to interact with user.</p>
<blockquote>
<p>std::array is more convenient than C array.</p>
</blockquote>
<p>It is. This item depends on the previous.</p>
<blockquote>
<p>There’s no need to 100% follow everything in it.</p>
</blockquote>
<p>If we don’t follow C++ Core Guidelines in 100%, I consider it as <em>different</em> guideline and item 2 in vote. Probably, I misunderstood the vote.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>