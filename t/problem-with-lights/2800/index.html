<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Problem with lights</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Problem with lights</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Liichi</div>
          <div class="post_content">
<p>Hi, i exported some trees from blender to my scene, but i have some problems with lights.<br/>
I don’t know if i did something worng during exporting or it’s an Urho3D bug.<br/>
Video: <a href="https://vid.me/asiI" rel="nofollow noopener">https://vid.me/asiI</a><br/>
Anyone know how fix it?<br/>
Thanks.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<p>I had similar problem when my Zone component was too small.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Liichi</div>
          <div class="post_content">
<p>I changed the zone bounds to 1000 but it still happens <img alt=":confused:" class="emoji" src="../../../images2/5fc0af8f196734b5bf5c1aacdc718a17.png" title=":confused:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1151_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">hdunderscore</div>
          <div class="post_content">
<p>Does the bounding box look correct? Does changing light range change the distance of the popping effect? Are the normals exported?</p>
<p>Looks like there is some z-fighting when you rotated the camera, that seems strange too.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Liichi</div>
          <div class="post_content">
<p>Does the bounding box look correct? Yes<br/>
Does changing light range change the distance of the popping effect? Yes<br/>
Are the normals exported? Yes i think, i follow the same steps to export all models of scene.<br/>
I noticed that if I use Diff.xml instead of VegetationDiff.xml the light works correctly.<br/>
It seems a VegetationDiff.xml bug. <img alt=":confused:" class="emoji" src="../../../images2/5fc0af8f196734b5bf5c1aacdc718a17.png" title=":confused:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Liichi</div>
          <div class="post_content">
<p>I found the problem, I was using a material only with the technique VegetationDiff.xml, when i add a new technique Diff.xml to the material the problem disappeared. <img alt=":slight_smile:" class="emoji" src="../../../images2/ab33f6c546ca85e7d84a4e3c32cd4034.png" title=":slight_smile:"/><br/>
It’s an issue or an noob error?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>Pls show your material (xml file)</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/66_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">szamq</div>
          <div class="post_content">
<p>What are your setup of near and far in camera? It looks like you set some large amount like 1000000 to far parameter.</p>
<p>Edit: Ah ok you already solved the issue:)</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Liichi</div>
          <div class="post_content">
<aside class="quote" data-full="true" data-post="7" data-topic="2800">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/ef19ff5c6f85c4920b8ebf7eda2e2ed6.png" width="20"/> 1vanK:</div>
<blockquote>
<p>Pls show your material (xml file)</p>
</blockquote>
</aside>
<p><a class="onebox" href="http://pastebin.com/t8KmqBgV" rel="nofollow noopener" target="_blank">http://pastebin.com/t8KmqBgV</a></p>
<p>Working material:<br/>
<a class="onebox" href="http://pastebin.com/JahVsMYm" rel="nofollow noopener" target="_blank">http://pastebin.com/JahVsMYm</a></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>material should contain only one technique with same lod</p>
<p>EDIT: <a href="https://urho3d.github.io/documentation/HEAD/_materials.html">https://urho3d.github.io/documentation/HEAD/_materials.html</a></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Liichi</div>
          <div class="post_content">
<p>Apparently, the second material only worked because Diff.xml was overwriting VegetationDiff.xml<br/>
Is there something wrong with the first material? (which only contains VegetationDiff.xml)</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>Vegetation should animate vertices of model, but I do not see it on video. So need more info about exporting settings</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Liichi</div>
          <div class="post_content">
<p>I realized that VegetationUnlit.xml works <img alt=":confused:" class="emoji" src="../../../images2/5fc0af8f196734b5bf5c1aacdc718a17.png" title=":confused:"/><br/>
I tried to export using .blend, .dae, .fbx formats but none worked.<br/>
I also tried using the urho plugin but i get the same problem.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1151_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">hdunderscore</div>
          <div class="post_content">
<p>Well I think I have spotted a typo or error in vegetation shader. Simple test, turn off dynamic instancing-- does the issue still occur?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Liichi</div>
          <div class="post_content">
<aside class="quote" data-full="true" data-post="14" data-topic="2800">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/02d61e3060a688b67b1e19db1fd8be9b.png" width="20"/> hdunderscore:</div>
<blockquote>
<p>Well I think I have spotted a typo or error in vegetation shader. Simple test, turn off dynamic instancing-- does the issue still occur?</p>
</blockquote>
</aside>
<p>No, everything works well (:</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1151_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">hdunderscore</div>
          <div class="post_content">
<p>Offending line is:<br/>
<aside class="onebox githubblob">
<header class="source">
<a  rel="nofollow noopener" target="_blank">github.com</a>
</header>
<article class="onebox-body">
<h4><a  rel="nofollow noopener" target="_blank">urho3d/Urho3D/blob/master/bin/CoreData/Shaders/HLSL/Vegetation.hlsl#L98</a></h4>
<pre class="onebox"><code class="lang-hlsl"><ol class="start lines" start="88" style="counter-reset: li-counter 87 ;">
<li>#endif
</li>
<li>out float4 oPos : OUTPOSITION)
</li>
<li>{
</li>
<li>// Define a 0,0 UV coord if not expected from the vertex data
</li>
<li>#ifdef NOUV
</li>
<li>float2 iTexCoord = float2(0.0, 0.0);
</li>
<li>#endif
</li>
<li>
</li>
<li>float4x3 modelMatrix = iModelMatrix;
</li>
<li>float3 worldPos = GetWorldPos(modelMatrix);
</li>
<li class="selected">
</li>
<li>float windStrength = max(iPos.y - cWindHeightPivot, 0.0) * cWindHeightFactor;
</li>
<li>float windPeriod = cElapsedTime * cWindPeriod + dot(worldPos.xz, cWindWorldSpacing);
</li>
<li>worldPos.x += windStrength * sin(windPeriod);
</li>
<li>worldPos.z -= windStrength * cos(windPeriod);
</li>
<li>
</li>
<li>oPos = GetClipPos(worldPos);
</li>
<li>oNormal = GetWorldNormal(modelMatrix);
</li>
<li>oWorldPos = float4(worldPos, GetDepth(oPos));
</li>
<li>
</li>
<li>#if defined(D3D11) &amp;&amp; defined(CLIPPLANE)
</li>
</ol></code></pre>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
</p>
<p>if anyone wants to confirm. Replacing cModel with modelMatrix seems to work.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Liichi</div>
          <div class="post_content">
<p>Works for me, ty <img alt=":smiley:" class="emoji" src="../../../images2/c16ddadcbd525aa6d219a1df596d362f.png" title=":smiley:"/><br/>
I think you should commit.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>