<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Soft Body Physics</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Soft Body Physics</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/774_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">dragonCASTjosh</div>
          <div class="post_content">
<p>I have recently noticed that Bullet has support for soft body physics built into it and feel that it would be a good addition to Urho, I’m not familiar with Bullet or the physics systems in Urho or else i would of given it a shot, but after a little look over the rigid body system in the engine i don’t look like to much work for someone with good understanding on the systems.</p>
<p>I gathered up some Bullet docs that may help anyone who wants to try an implement soft bodies,<br/>
btSoftRigidDynamicsWorld: <a data-bbcode="true" href="http://bulletphysics.org/Bullet/BulletFull/classbtSoftRigidDynamicsWorld.html">http://bulletphysics.org/Bullet/BulletFull/classbtSoftRigidDynamicsWorld.html</a><br/>
btRigidBody: <a data-bbcode="true" href="http://bulletphysics.org/Bullet/BulletFull/classbtRigidBody.html">http://bulletphysics.org/Bullet/BulletFull/classbtRigidBody.html</a></p>
<p>I also found a reference video of soft body physics implemented using bullet:</p>
<div class="lazyYT" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque" data-width="480" data-youtube-id="9sh-D0nejUY" data-youtube-title="Bullet 2.70 real-time soft body and rigid body simulation"></div>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/119_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">codingmonkey</div>
          <div class="post_content">
<p>Hi dragon or josh )<br/>
Actually I try to write something like this earlier, but then i drop code for some reason, i’m do not remember why maybe it has been very complicated for me.<br/>
i’m fully based on this tutorial when doing my trying of this.<br/>
there are some major problems.</p>
<ol>
<li>the mesh must always dynamically update, you recreate it everytime from bullet</li>
<li>the format must contain “pins vertices” array. I do not know how this make with actual model formal (*.mdl). probably for soft bodies need new special file format to do exports from blender or assetimport tool.</li>
</ol>
<div class="lazyYT" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque" data-width="480" data-youtube-id="d7_lJJ_j2NE" data-youtube-title="Bullet physics tutorial 5 - Basics of softbodies"></div>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/774_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">dragonCASTjosh</div>
          <div class="post_content">
<p>hi codingmokey</p>
<p>I think it may be worth me having a try using the tutorial see how it ends up, also i feel there is probably an optimisation soft body updates and they are likely to be used in small amounts within games. As for model formats i believe FBX formats can handle soft body data but not sure if assimp imports this data and i am also not sure about mdl. but a new format to support soft bodies don’t sound to bad</p>
<p>btw you can call me josh <img alt=":slight_smile:" class="emoji" src="../../../images2/ab33f6c546ca85e7d84a4e3c32cd4034.png" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Lumak</div>
          <div class="post_content">
<p>I thought it would be fun to actually port this (softbody physics) to Urho.</p>
<p>Here is a softbody mushroom vid</p>
<div class="lazyYT" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque" data-width="480" data-youtube-id="XkLMAZWaVB8" data-youtube-title="Urho3D SoftBody Demo"></div>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/774_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">dragonCASTjosh</div>
          <div class="post_content">
<aside class="quote no-group" data-username="Lumak">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/b3b294bc4454bf21e07a40d7aa09761d.png" width="20"/> Lumak:</div>
<blockquote>
<p>I thought it would be fun to actually port this (softbody physics) to Urho.</p>
</blockquote>
</aside>
<p>For some reason i found that so funny the way it wobbles, is the source for that public</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Lumak</div>
          <div class="post_content">
<p>I can post the code sample on the code exchange, but I have to tell you that it’s no where near code complete.  I was only interested in creating a trimesh softbody and that’s the only thing that I implemented.  I didn’t put any hooks on debug render or add methods like, settransform(), setmass(), etc.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/119_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">codingmonkey</div>
          <div class="post_content">
<blockquote>
<p>Here is a softbody mushroom vid<br/>
it’s funny )<br/>
did you test clothes with pins or maybe something like long hair ?<br/>
Is it possible make some part of one solid static mesh as softbody ?</p>
</blockquote>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/774_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">dragonCASTjosh</div>
          <div class="post_content">
<aside class="quote no-group" data-username="Lumak">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/b3b294bc4454bf21e07a40d7aa09761d.png" width="20"/> Lumak:</div>
<blockquote>
<p>I can post the code sample on the code exchange</p>
</blockquote>
</aside>
<p>that would be useful.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Lumak</div>
          <div class="post_content">
<p>I posted it on the <a href="http://discourse.urho3d.io/t/bullets-softbody-physics-example/1319">code exchange</a>.</p>
<p><span class="mention">@codingmonkey</span>, I didn’t try those.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/119_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">codingmonkey</div>
          <div class="post_content">
<p>i’m try to figure out with this.<br/>
i look into urho’s physics. And i’m do not understand if RigidBody use CollisionShapes component for store it’s own colliding shape (various types).<br/>
Is SoftBody still needed to use collisionShapes or some other collider if they just create from btSoftBodyHelpers::CreateFromTriMesh ?<br/>
Maybe instead CollisionShape they must use something like SoftBodyShape just for store only they’s TriMesh with some adjustments ?<br/>
I mean if Rigidbody every time need his dual component - CollsionShape, in this case I guess that SoftBody needed his dual component SoftBodyShape.<br/>
But again it also maybe all in one, SoftBody just may store own TriMesh in it self, and in this case it don’t needed any ****shape dual component.</p>
<p>Also I see in Bullet Examples/SoftDemo.cpp about cutting SoftBody if i’m think right it is slice mesh into pieces ? and these separated parts are falling down if they are sliced or just disappear ?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Lumak</div>
          <div class="post_content">
<p>Looking at the btSoftBody.h file, I see that the class inherits from public btCollisionObject and there is a <span class="bbcode-b">struct Body</span> which defines a btRigidBody* along with Cluster*.  It looks to me like it creates its own set of collision objects and make use of rigidbodies (all in one, as you mentioned) without having to add any additional collision shape or rigidbody for any of the softbody types.  The <span class="bbcode-b">void (<em>demofncs[])(SoftDemo</em>)</span> defines all the examples in the softbody demo. I’d trace those init functions for specific examples.</p>
<p>I can see in the cutting demo that it actually cuts part of the mesh which falls and have colliders themselves.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/119_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">codingmonkey</div>
          <div class="post_content">
<p>Also i want to note that there are have some major problems with tbSoftBody for realtime simulation. but all they are solvable i guess.</p>
<ol>
<li>
<p>btSoftBody do not weak up after they turn to sleeping. Actual version of Bullet still do not solve this issue. but there are exist path to solve this, and it give boost in performance.<br/>
for more details: <a href="https://code.google.com/p/bullet/issues/detail?id=439">code.google.com/p/bullet/issues/detail?id=439</a></p>
</li>
<li>
<p>for btSoftBody you will need keep special vertex array to simulate clothes. And map this vertexes into original geometry every Physics tick.<br/>
for more details: <a href="http://www.bulletphysics.org/Bullet/phpBB3/viewtopic.php?f=9&amp;t=10154">bulletphysics.org/Bullet/php … =9&amp;t=10154</a></p>
</li>
</ol>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Shylon</div>
          <div class="post_content">
<p>Any News on Urho3d Soft-body physics?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/173_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">bmcorser</div>
          <div class="post_content">
<p>I’m interested in this too. Is there a branch somewhere with this partially integrated into Urho?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>Seen this thread?</p><aside class="quote quote-modified" data-post="1" data-topic="1319">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" loading="lazy" src="../../../images2/b3b294bc4454bf21e07a40d7aa09761d.png" width="20"/>
<a href="http://discourse.urho3d.io/t/bullets-softbody-physics-example/1319">Bullet's SoftBody physics example</a> <a class="badge-wrapper bullet" href="/c/showcase/code-exchange/13"><span class="badge-category-parent-bg" style="background-color: #F1592A;"></span><span class="badge-category-bg" style="background-color: #231F20;"></span><span class="badge-category clear-badge" data-drop-close="true" style="" title="Share your helpful Urho3D code snippets, samples and tutorials here.">Code Exchange</span></a>
</div>
<blockquote>
    I became interested in porting bullet’s softbody physics after reading Josh’s post, <a data-bbcode="true" href="http://discourse.urho3d.io/t/soft-body-physics/1313/1">http://discourse.urho3d.io/t/soft-body-physics/1313/1</a>. 
And the thing that I was really interested in was TriMesh softbody implementation, curious as to whether the softbody needed to be recreated every frame or if just updating the model’s vertex buffer would work. 
This example shows trimesh softbody implementation that updates model’s vertex buffer.  It’s no where near code complete, as I have neglected to wri…
  </blockquote>
</aside>

          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/173_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">bmcorser</div>
          <div class="post_content">
<p>Yeah, a seemingly no-longer-existing branch on GitHub is referenced: <a href="https://github.com/MonkeyFirst/Urho3D/tree/sbtest" rel="nofollow noopener">https://github.com/MonkeyFirst/Urho3D/tree/sbtest</a></p>
<p>I wonder if <span class="mention">@codingmonkey</span> still has a copy somewhere <img alt=":grinning:" class="emoji" src="../../../images2/993cdd6d5aba3f941b7389fd0b3a1ba1.png" title=":grinning:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<aside class="quote">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/e5061c7629059aca42f3242b52d42e88.png" width="20"/> codingmonkey:</div>
<blockquote>
<p>Yes, probably i also dont have it even on my hdd (<br/>
but all code changes (sources) are in this theme - hided by code/spoilers tag.<br/>
I also remember last bug with my SB: i have huge offset between visual SB representation and it physic representation.</p>
</blockquote>
</aside>
<p>You could reconstruct a branch with the code in the thread.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>