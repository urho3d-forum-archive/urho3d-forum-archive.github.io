<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Preventing weapons from going through walls</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Preventing weapons from going through walls</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">smellymumbler</div>
          <div class="post_content">
<p>I’m building a small FPS example in Urho and i’m facing the following bug that i also experienced in Unity: <a href="https://www.youtube.com/watch?v=9kekrsZzLG8" rel="nofollow noopener">https://www.youtube.com/watch?v=9kekrsZzLG8</a></p>
<p>However, i don’t know how to fix it in Urho. Any tips?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>Camera::SetViewMask()<br/>
(but it is not cool method - shadows from another objets do not drop on weapon)</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2367_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jmiller</div>
          <div class="post_content">
<p>Similar question is asked with solutions here:</p><aside class="quote" data-post="1" data-topic="1240">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" loading="lazy" src="../../../images2/2c165096ad375255e0c52a6a81137cd8.png" width="20"/>
<a href="http://discourse.urho3d.io/t/how-to-control-render-order/1240">How to control render order?</a> <a class="badge-wrapper bullet" href="/c/discussions/support/10"><span class="badge-category-parent-bg" style="background-color: #25AAE2;"></span><span class="badge-category-bg" style="background-color: #92278F;"></span><span class="badge-category clear-badge" data-drop-close="true" style="" title="Someone can help you.">Support</span></a>
</div>
<blockquote>
    How can you control render order? 
A use case for example is an FPS game. You don’t want the player’s gun to clip with world objects that get too close. So you need to render the gun on top of everything.
  </blockquote>
</aside>

          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">smellymumbler</div>
          <div class="post_content">
<p>First of all, thanks for the quick replies! <img alt=":grin:" class="emoji" src="../../../images2/ec34c8e58665ec32c0e7c847446db86d.png" title=":grin:"/></p>
<p>I’ve checked that thread before, but that solution comes with a bug: when inside a wall, the weapon is shadowed. During gameplay, this is very noticeable. Is there another way of doing this with Urho?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>At the moment, I believe, the best method is move gun backward (or to side) when gun collides to objects. This is done in many modern games</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">smellymumbler</div>
          <div class="post_content">
<p>Pushing back without IK would look terrible, as if the player was going into aim down the sights. Or am i not understanding correctly?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>I do not understand why you need IK here, just move model with hands backward</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">smellymumbler</div>
          <div class="post_content">
<p>Because if i just move the weapon model and the arms model along the Z axis, it’s going to look as if it was zooming in and out, not actually moving the arms to avoid collision. The only proper way of doing that is to rotate the elbow bone and also the hand bone, OR some sort of IK to avoid collision. That’s why i chose the camera fix in Unity, easier.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2367_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jmiller</div>
          <div class="post_content">
<p>I thought the above thread actually addressses the shadow issue (but perhaps with some caveats) <img alt=":slight_smile:" class="emoji" src="../../../images2/ab33f6c546ca85e7d84a4e3c32cd4034.png" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">HplusDiese</div>
          <div class="post_content">
<p>What about projection matrix hack for this? Useful thing.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<blockquote>
<p>What about projection matrix hack for this? Useful thing.</p>
</blockquote>
<p><a href="http://discourse.urho3d.io/t/depthhack-for-weapon-rendering/2202">DepthHack for weapon rendering</a><br/>
no one know how to do it )</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">HplusDiese</div>
          <div class="post_content">
<p>You can use custom Render Path command for drawing fps related stuff.<br/>
Maybe i implement it later.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>