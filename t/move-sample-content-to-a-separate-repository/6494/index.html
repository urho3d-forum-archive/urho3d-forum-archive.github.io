<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Move sample content to a separate repository</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Move sample content to a separate repository</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>From what I know main Urho3D doesn’t accept new heavy samples content (models, textures, etc) to prevent main repository from bloat. Why not to cut sample content into separate repository like for sample gltf viewer does?<br/>
</p><aside class="onebox githubblob">
<header class="source">
<a href="https://github.com/KhronosGroup/glTF-Sample-Viewer/blob/master/.gitmodules" rel="noopener nofollow ugc" target="_blank">github.com</a>
</header>
<article class="onebox-body">
<h4><a href="https://github.com/KhronosGroup/glTF-Sample-Viewer/blob/master/.gitmodules" rel="noopener nofollow ugc" target="_blank">KhronosGroup/glTF-Sample-Viewer/blob/master/.gitmodules</a></h4>
<pre><code class="lang-gitmodules">[submodule "assets/models"]
	path = assets/models
	url = https://github.com/KhronosGroup/glTF-Sample-Models.git
[submodule "assets/environments"]
	path = assets/environments
	url = https://github.com/KhronosGroup/glTF-Sample-Environments.git
</code></pre>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>

          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>Yes, it makes perfect sense for full blown sample games to be in separate repository, whether it is still in the “urho3d” org on GitHub or under its main author personal account on GitHub. However, the current basic samples should stay where they are. Maintaining them separately will have extra overhead if we have 50 repos for 50 basic samples. My two cents.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Why would you have a repository per sample?</p>
<p>From my point of view an advantage of separate repository would be an ability to squash git history to minimize repository size. In this case a user will download only actual sample content.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>If you have plan to contribute a new more elaborate sample with its own assets and that it does not fit the definition of basic samples that I was referring to earlier then I agree with you that it can be in a separate repo too. It does not have to be under “urho3d” org. But we could make exception if its author, you or any other person, promise to maintain it. Not a one time drop, please take it and gone.</p>
<p>The existing basic samples are really intended to show one or two simple concepts at a time. Using the same shared assets. There is really not much change to those throughout the change history.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>I agree that the repository should have a minimum number of examples that simply serve to test the engine code. It makes no sense to drag all examples, games and even components into the engine repository. We already have a page where users can post links to their components: <a >https://github.com/urho3d/Urho3D/wiki</a></p>
<p>I also agree that the engine repository is ALREADY bloated. We can create a separate repository with squashed commits for each new major version of Urho.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>Perhaps I should mention that I have a plan to revamp the main website. The new one will have more prominent place to list the good samples out here using Urho3D library. So it does not really matter where the repo will be, if it is good then it will be linked and easily discoverable.</p>
<p>That was the original plan anyway, before I got interrupted. The new CI/CD workflow does not update the site documentation anymore. This part has not actually completed yet. But yeah, otherwise the plan is/was to make the workflow somehow update to a new parallel website before cut over. That’s the other fish that I wanted to fry in one of my comment in other thread.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>I actually don’t like the idea. There are countless of time I find the history is so useful. You just clone once. Yes, it is slow for the first time. But after that, subsequent pulls are fast as per normal regardless of how long the history is. What’s inside the history is the real treasure. I can see and study the rationale behind Lasse original work since the inception of this project. We have not lost a single bit of the history when I helped him to migrate from SVN to GIT. And, I am sure I will not agree to do that intentionally now.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<aside class="quote no-group" data-post="5" data-topic="6494" data-username="1vanK">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/8e14485e10e801cd7ee7668b4f98a5bf.png" width="20"/> 1vanK:</div>
<blockquote>
<p>It makes no sense to drag all examples, games and even components into the engine repository</p>
</blockquote>
</aside>
<p>I mostly agree.</p>
<p>However, it’s also bad to have engine code that is not used in samples.<br/>
Samples provide some basic way to test things. Without samples or tests, these parts of engine would be just dead code that could stay broken for years without anyone noticing.</p>
<p>Just a random example, Urho supports per-vertex lights (in theory). But there’s no sample for this feature. In practice, point vertex lights have obviously wrong lighting that depends on light orientation.<br/>
I don’t know how long ago it was broken, or if it even worked, ever.</p>
<p>And this is just one place that I found randomly while playing around with Urho renderer.</p>
<p>PS: I <em>think</em> it should be enough to just replace -1 with -2 here, but it’s just my wild guess and I didn’t properly test this change.<br/>
</p><aside class="onebox githubblob">
<header class="source">
<a  rel="noopener nofollow ugc" target="_blank">github.com</a>
</header>
<article class="onebox-body">
<h4><a  rel="noopener nofollow ugc" target="_blank">urho3d/Urho3D/blob/master/Source/Urho3D/Graphics/Batch.cpp#L559</a></h4>
<pre class="onebox"><code class="lang-cpp"><ol class="start lines" start="549" style="counter-reset: li-counter 548 ;">
<li>    invRange = 0.0f;
</li>
<li>else
</li>
<li>    invRange = 1.0f / Max(vertexLight-&gt;GetRange(), M_EPSILON);
</li>
<li>if (type == LIGHT_SPOT)
</li>
<li>{
</li>
<li>    cutoff = Cos(vertexLight-&gt;GetFov() * 0.5f);
</li>
<li>    invCutoff = 1.0f / (1.0f - cutoff);
</li>
<li>}
</li>
<li>else
</li>
<li>{
</li>
<li class="selected">    cutoff = -1.0f;
</li>
<li>    invCutoff = 1.0f;
</li>
<li>}
</li>
<li>
</li>
<li>// Color
</li>
<li>float fade = 1.0f;
</li>
<li>float fadeEnd = vertexLight-&gt;GetDrawDistance();
</li>
<li>float fadeStart = vertexLight-&gt;GetFadeDistance();
</li>
<li>
</li>
<li>// Do fade calculation for light if both fade &amp; draw distance defined
</li>
<li>if (vertexLight-&gt;GetLightType() != LIGHT_DIRECTIONAL &amp;&amp; fadeEnd &gt; 0.0f &amp;&amp; fadeStart &gt; 0.0f &amp;&amp; fadeStart &lt; fadeEnd)
</li>
</ol></code></pre>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>

          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>I am not confirming nor rejecting, but I can easily check and see that the line has not changed since the project inception. And I could know that precisely because the historical is still there.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>I think we have to get back to the main topic. And I need to get back to work. <img alt=":grin:" class="emoji" src="../../../images2/ab418b6a2a0bf690d1ca04fff8b57495.png" title=":grin:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<aside class="quote no-group" data-full="true" data-post="7" data-topic="6494" data-username="weitjong">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/8c3888d68a9e52e853f0724aae6cefb6.png" width="20"/> weitjong:</div>
<blockquote>
<p>I actually don’t like the idea. There are countless of time I find the history is so useful. You just clone once. Yes, it is slow for the first time. But after that, subsequent pulls are fast as per normal regardless of how long the history is. What’s inside the history is the real treasure. I can see and study the rationale behind Lasse original work since the inception of this project. We have not lost a single bit of the history when I helped him to migrate from SVN to GIT. And, I am sure I will not agree to do that intentionally now.</p>
</blockquote>
</aside>
<p>The history will not be lost anywhere, the history will remain in the repository of the previous version of the engine</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>But then it is not as useful. Because you have to jump one tag to the next to get to the bottom of it.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Let’s use terrain shader update as an example.</p>
<p>I have an update for terrain shader to support up to 5 textures. <span class="mention">@1vanK</span> ask me to create a sample for it. This means I have to make a scene with 5 terrains each representing different number or textures. I can probably reuse textures that already exist in the project but I’ll need at least 2 blendmaps for terrain because for 5 textures I’ll need unnormalized RGBA weights as fifth weight is calculated as (1-R-G-B-A).</p>
<p>Another example would be a character controller. For a proper test of a character controller there should be a scene that represents a game-like environment with stairs, gaps to jump across, etc. Boxes and mushrooms are not enough.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<aside class="quote no-group" data-post="9" data-topic="6494" data-username="weitjong">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/8c3888d68a9e52e853f0724aae6cefb6.png" width="20"/> weitjong:</div>
<blockquote>
<p>I am not confirming nor rejecting, but I can easily check and see that the line has not changed since the project inception</p>
</blockquote>
</aside>
<p><em>sorry for offtopic&lt;/&gt;</em> It’s a bit more complicated than just checking this specific line, one would need to review all the shaders that use this variable in order to get full picture. Still doable with git history, tho.</p>
<p>I cannot imagine myself doing bug investigation without repository history, to be honest.<br/>
Squashing works fine for periodically updated 3rdparties, but squashing main repo?.. Ew, sounds terrible.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>I asked for a test scene to test the shader before the merge. I didn’t plan to include the scene in the engine. Although you’re right, this is a scene that should check if the engine is working.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>Another question is whether shaders are part of the engine. In fact, I think shaders are resources for a game, not part of the engine. Each game often has its own shaders. If some shader requires a change in the engine, then it makes sense to consider it essential.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>Look it: <a class="inline-onebox" href="https://discourse.urho3d.io/t/basic-material-effects-for-rendering/2953">Basic material effects for rendering</a></p>
<p>It’s cool but should we include this to the engine?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>No, but the whole shader system requires a rework.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<aside class="quote no-group" data-post="16" data-topic="6494" data-username="1vanK">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/8e14485e10e801cd7ee7668b4f98a5bf.png" width="20"/> 1vanK:</div>
<blockquote>
<p>In fact, I think shaders are resources for a game, not part of the engine. Each game often has its own shaders.</p>
</blockquote>
</aside>
<p>The engine (any, not just Urho) has very specific requirements about shaders.<br/>
The engine expects shader to receive certain input data in certain format, and it expects shader to deliver output data in some other format.<br/>
These requirements are huge and they are not documented directly (at least in Urho): one have to look at existing shaders (and likely reuse them) in order to make custom shader.</p>
<p>So, at least the interface part of shaders is a part of engine.<br/>
So it’s better be reasonably covered with samples (and sample shaders) so we don’t get dead code.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Ugh… Then I misunderstood the request. If the sample won’t be part of the engine repo how would you test any changes to the shader?</p>
<p>Shall shader have a reference to github repo then with a test scene?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>I already mentioned in my post about shaders that require an engine change. But we are talking about shaders that are nice, but do not require changing the engine. This is not the first attempt to improve the ground shader. Somewhere there was already a shader with trilinear texturing of terrain.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p>I would prefer to leave the shader in a separate repository along with the test scene. I can test the shader on my pc, but cannot test on a mobile device which will impose additional restrictions.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/768_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">1vanK</div>
          <div class="post_content">
<p><a href="https://urho3d.fandom.com/wiki/Expand_default_terrain_material_to_4_textures_using_alpha_channel">https://urho3d.fandom.com/wiki/Expand_default_terrain_material_to_4_textures_using_alpha_channel</a><br/>
<a href="https://urho3d.fandom.com/wiki/Expand_default_terrain_material_to_7_textures_using_the_six_primary%26secondary_colors_and_black">https://urho3d.fandom.com/wiki/Expand_default_terrain_material_to_7_textures_using_the_six_primary%26secondary_colors_and_black</a><br/>
<a href="https://urho3d.fandom.com/wiki/Height_Mapping">https://urho3d.fandom.com/wiki/Height_Mapping</a><br/>
<a href="https://urho3d.fandom.com/wiki/Terrain_Shader_with_normal,_specular_and_height_mapping">https://urho3d.fandom.com/wiki/Terrain_Shader_with_normal,_specular_and_height_mapping</a></p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>