<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Update SDL 2.0.12</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Update SDL 2.0.12</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>I’ve started a branch to update SDL from 2.0.10 to 2.0.12 as hdiapi gamepad support in 2.0.10 is awful.</p>
<aside class="onebox githubpullrequest">
<header class="source">
<a  rel="noopener nofollow ugc" target="_blank">github.com/urho3d/Urho3D</a>
</header>
<article class="onebox-body">
<div class="github-row">
<div class="github-icon-container" title="Pull Request">
<svg aria-hidden="true" class="github-icon" height="60" viewbox="0 0 12 16" width="60"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
</div>
<div class="github-info-container">
<h4>
<a  rel="noopener nofollow ugc" target="_blank">SDL 2.0.12</a>
</h4>
<div class="branches">
<code>urho3d:master</code> ← <code>gleblebedev:SDL2_0_12</code>
</div>
<div class="github-info">
<div class="date">
        opened <span class="discourse-local-date" data-date="2020-10-24" data-format="ll" data-time="22:27:13" data-timezone="UTC">10:27PM - 24 Oct 20 UTC</span>
</div>
<div class="user">
<a href="https://github.com/gleblebedev" rel="noopener nofollow ugc" target="_blank">
<img alt="gleblebedev" class="onebox-avatar-inline" height="20" src="../../../images2/9b7a8c5665fd24addbda873936dfb587" width="20"/>
          gleblebedev
        </a>
</div>
<div class="lines" title="1 commits changed 780 files with 41717 additions and 8824 deletions">
<a  rel="noopener nofollow ugc" target="_blank">
<span class="added">+41717</span>
<span class="removed">-8824</span>
</a>
</div>
</div>
</div>
</div>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>It doesn’t even compile on windows yet. Any help is welcome.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>I could have a look but not after I wrap up a few other things in the dev branch I am currently working on. But I will most probably start a new instead of fixing on top of yours.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Shall I abandon this one then?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>If you still want to try to get it work then no harm to keep the PR there first. I actually haven’t looked at it though. Who knows it is just a simple mistake.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>I suspect the problem is in cmake file.</p>
<p>If you going to do it yourself in next couple weeks I can wait. Otherwise I’ll try to make it work.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>We are using heavily modified CMake build scripts. For sure you cannot just simply replace that with the original but upgraded scripts from SDL and expect it to work.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>I didn’t replace it, I kept the one that was in Urho. Although it is hard to track what is different there since it is very different from original SDL 2.0.10 cmake.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>My question is if you have a SDL upgrade timeline on mind or it may happen “some time in future”.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>I know exactly what you are saying. Believe me. Over the years, I have come up with my own way to keep track of the local as well as the upstream changes and able to “systematically” merge the changes together. However, it is still rather a convoluted process using git and vi to resolve any conflicts. Not easy for me to elaborate here, although I have written the gist of it in my personal github account. It was a mental notes for myself and I don’t expect anyone else to read and understand from it.</p>
<p>I don’t have a specific timeline for it. Actually I have another bigger fish to fry in my current dev branch.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Ok, then  I’ll try to make it work myself.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Btw do you know how to switch joystick support from hid to xinput or xinput? This would also work for me fine.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>7 posts were split to a new topic: <a href="/t/return-of-the-nag/6459">Return of the nag</a></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>I am also not the expert of SDL. I just know one thing or two on how to get the upstream changes merge into the Urho3D from earlier experience through trial and error. Practice makes perfect, they say. However, in actual fact, for each upgrade I have to spend a lot of time and energy to reconcile the conflict, but I am not as fit anymore. I just have a systematical way to identify the changes (thanks to Git), but the hard labor is in conflict resolution. In other words, whether you and I have the systematic way for performing the upgrade or not, we both will face the same daunting task. And, no, I don’t know the answer to your last question.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>What happened to 2.0.11? They just jumped from 2.0.10 to 2.0.12?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Looks like it… I don’t know why.</p>
<p>I also wonder if they going to produce 2.0.13 in the middle of the merge… That would be unfortunate <img alt=":slight_smile:" class="emoji" src="../../../images2/7bdd5ab4d67675d002d99e4b948c8cdb.png" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>May I ask you where SDL_EXPORTS is defined? I can’t find it in cmake files…</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>It is used there but I can’t find where it is defined…</p>
<pre><code>// Urho3D: Only export when it is being requested
#ifdef SDL_EXPORTS</code></pre>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>I think it is basically just a way to make it not exported. Urho3D builds all its sub-libraries as STATIC.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Samples reference Urho3D. Urho3D reference SDL. Sample compilation fails because of missing SDL functions like SDL_free.</p>
<p>Any ideas why it would be?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>You meant building “Urho3D” lib itself is fine? And only failed in samples?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Exactly.</p>
<p>And now few words to make reply longer than 20 chars.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>It means the symbol is eliminated in the final Urho3d lib, but that’s not correct. It’s hard to guess the root cause though. Ensure you are using STATIC lib type for SDL. Check the generated SDL config file is identical to previous one before upgrade, or at least it should be similar and diffs are acceptable.</p>
<p>I suppose you are using SHARED lib type for Urho3D lib itself?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>Also you have to use the same Urho3D-specific macro to add/setup the SDL lib. You cannot use the CMake command as per original build script from SDL. In the background our macro does a number of heavy lifting. One of the task is to mark which archive containing the *.obj should be used in building the final engine lib.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>I’m not using SDL cmake script. I moved all changes to 2.0.12 I could move to the existing Urho3D SDL file.</p>
<p>I’m running cmake script for vs2019 from scripts folder with default settings, so whatever is by default…</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>By that you should be using STATIC lib type for the engine too. The STATIC lib type is just an archive of all *.obj from Urho3D and all its sub-libs including SDL. So there is no reason for the downstream using the final lib to have missing symbol, unless the symbol is not there in the first place. Can you check the archive from SDL to see if it still has SDL_free? In Linux the archive file is the *.a. Not sure on Windows, *.lib perhaps. In Linux we use “nm” command to check the content of the archive file. Again, not sure on Windows.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>Perhaps you should try to use SHARED lib type for the Urho3D lib. This way it should be linked against the SDL lib, so if you have issue with SDL then the problem should hopefully show up while building the engine lib.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p><code>Section length  9AA, #relocs   6A, #linenums    0, checksum 5E719D6B</code><br/>
<code>00F 00000000 UNDEF  notype ()    External     | SDL_free</code></p>
<p>With the new SDL build:<br/>
<code>00C 00000000 UNDEF  notype ()    External     | SDL_free_REAL</code></p>
<p>Wtf is that _REAL part?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>So it seems dynapi wasn’t disabled properly?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p><span class="mention">@weitjong</span> ok, I’ve missed a change in dynapi header.</p>
<p>Looking into .lib was a good idea, thanks!</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Well, it’s a start!</p>
<p><div class="lightbox-wrapper"><a class="lightbox"   rel="noopener nofollow ugc" title="image"><img alt="image" data-base62-sha1="xu0ICjowwThnodVVAo2X7BQek1b"  height="499" src="../../../images2/123168a210d3e0e4606b9c8f85d5ae8a.png"  width="641"/><div class="meta"><svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1032×804 35.3 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Also my xbox controller works now. So it wasn’t for nothing.I have around 10 files to merge and then it should be ready for review.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p><span class="mention">@glebedev</span> You must know, it’s good to see you working on Urho proper. <img alt=":slight_smile:" class="emoji" src="../../../images2/7bdd5ab4d67675d002d99e4b948c8cdb.png" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>I guess I didn’t break the LSEEK, right? <a  rel="noopener nofollow ugc">https://github.com/urho3d/Urho3D/pull/2706/checks?check_run_id=1326432936</a></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>No, you didn’t. I have explained it to you separately in the PR.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/259_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Pencheff</div>
          <div class="post_content">
<p>I’m also trying to update, SDL 2.0.22, some builds are failing:</p><aside class="onebox githubactions" data-onebox-src="https://github.com/PredatorMF/Urho3D/actions/runs/2563944700">
<header class="source">
<a href="https://github.com/PredatorMF/Urho3D/actions/runs/2563944700" rel="noopener nofollow ugc" target="_blank">github.com</a>
</header>
<article class="onebox-body">
<div class="github-row">
<div class="github-icon-container" title="Commit">
<svg aria-hidden="true" class="github-icon github-icon-pending" height="24" viewbox="0 0 24 24" width="24"><path d="M12 18a6 6 0 100-12 6 6 0 000 12z"></path></svg>
</div>
<div class="github-info-container">
<h4>
<a href="https://github.com/PredatorMF/Urho3D/actions/runs/2563944700" rel="noopener nofollow ugc" target="_blank">Add missing dbus files to CMakeLists.txt</a>
</h4>
<div class="github-info">
        CI/CD <span class="github-run-number">#3</span>
</div>
</div>
</div>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>Suggestions are welcome</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>