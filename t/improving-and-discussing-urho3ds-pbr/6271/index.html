<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Improving and discussing Urho3D&rsquo;s PBR</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Improving and discussing Urho3D&rsquo;s PBR</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1815_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">dertom</div>
          <div class="post_content">
<p>EDIT(<em>removed the request to move discussion from another topic here so this won’t get lost</em>):<br/>
Discussion about PBR:</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<p>Agreed. Nope, I cannot, I’m just a regular user. <s>Modanung, can you please clean up project shots topic a bit? It’s really getting off-topic.</s> Thanks Wei Tjong.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>Too bad you can’t really use PBR for real-time aside from just simple renders.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<p>What do you mean?.. In Unity PBR is literally default shader, and thousands of games use it.<br/>
Any (or almost any) 3D AAA game for last 5+ years is using PBR is one form or another.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p><span class="mention">@Eugene</span>  I meant Urho3d not other engines.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2836_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">extobias</div>
          <div class="post_content">
<p><span class="mention">@GodMan</span> and why is that? why isn’t usable in real time?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>From everything I have read on the forums. If you tried to make a game using PBR that it was to slow.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1815_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">dertom</div>
          <div class="post_content">
<p>Is it possible to discuss on other topics than ‘Random project shots’?</p>
<p>Edit by weitjong: Moved here as per your request.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3220_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">JSandusky</div>
          <div class="post_content">
<p><span class="mention">@GodMan</span> regarding PBR, on IBL cube textures turn off anisotropy (Urho’s default is 4) and set the filter mode to linear.</p>
<p>Other costs include:</p>
<ul>
<li>Doesn’t use a split-sum LUT-texture which is cheaper on PC than the approximation used (which is meant for mobile where texture reads hurt much more than ALU). It doesn’t use one because the BRDF isn’t set in stone (see final word)</li>
<li>Redundancies in calculations (roughness * roughness over and over again, once you settle pack your data once into a struct and pass that around instead) depending which BRDF parts you’re using</li>
<li>poor format support in Urho3D (RGBA16_F should be used for IBL cubes or use RGBM8), hardware sRGB has spotty performance from GPU to GPU (even of the same vendors)</li>
<li>shader IBL defaults expect an unreasonably large texture (if you’re using more 256x256x6 for an IBL cube you’re probably a moron).</li>
<li>Legacy lighting systems incur significant costs due to repeated setup math compared to tiled or clustered shading, there’s no debate on whether one nDotV or 64 nDotV’s is cheaper.</li>
<li>That Urho3D default of 4x anistropic filtering hurts (mostly because of all of the above), seriously consider DDS and pre-generating your mips instead for your usage</li>
</ul>
<p>PBR is a base for an environment where no one can agree on even the tiniest thing about how it should be, tweak it to be what you need it to be. Lock down how you want to do it, then tweak and it should be comparable to everything else. Sure you could have it fast out of the box, but then your luck you’d be the guy that can’t stand having to deal with DDS/KTX and the delay while your new textures are being Toksvig’ed.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p><span class="mention">@JSandusky</span> so basically it is implemented poorly.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1669_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GoldenThumbs</div>
          <div class="post_content">
<p>I’m pretty sure rgba16f textures are supported in Urho3d. Am I mistaken, or misunderstanding what you mean?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1669_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GoldenThumbs</div>
          <div class="post_content">
<p><span class="mention">@JSandusky</span><br/>
After looking up some stuff I think I figured out what you meant. You mean that Urho can’t save to any file format that saves to something with that sort of precision, correct?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<aside class="quote no-group" data-post="12" data-topic="6271" data-username="GoldenThumbs">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/28b5739e5dec60ed145b9694658536d4.png" width="20"/> GoldenThumbs:</div>
<blockquote>
<p>You mean that Urho can’t save to any file format that saves to something with that sort of precision, correct?</p>
</blockquote>
</aside>
<p>As far as I remember, Urho cannot <em>load from</em> any floating-point format either.<br/>
This is so annoying. I cannot even properly store baked lightmaps, I have to use RGBA8.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">SirNate0</div>
          <div class="post_content">
<p>Would adding OpenEXR support alleviate the problem? I haven’t looked in detail but it looks like it would be pretty straightforward and I believe the license would be compatible.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<aside class="quote no-group" data-post="14" data-topic="6271" data-username="SirNate0">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/fb52f23a6782e890737d90432eac55f2.png" width="20"/> SirNate0:</div>
<blockquote>
<p>Would adding OpenEXR support alleviate the problem?</p>
</blockquote>
</aside>
<p>Not in the slightest, sadly.<br/>
Format is not an issue, DDS is perfectly capable of handling basically any uncompressed (and some compressed) image formats.</p>
<p>The issue is that Urho handles all images via <code>Image</code> class, which is hardcoded to RBG(A)8 layout.<br/>
Exception are compressed formats, but they are read-only.</p>
<p>The only realistic option (=that doesn’t involve screwing the interface of <code>Image</code>) I see is to add artificial “compressed” formats for RGBA16 and so on.<br/>
And teach <code>SaveDDS</code> how to save compressed formats.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1669_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GoldenThumbs</div>
          <div class="post_content">
<p>Also BMP should be able to save any uncompressed format too. So the issue is entirely with the image class? Perhaps one could overhaul the image class? That probably entails way more than it initially sounds. Why is the image class locked to 8 bit precision anyway? Is this an issue with the engine being as old as it is?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1669_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GoldenThumbs</div>
          <div class="post_content">
<p>Frankly I think the best option would be to overhaul the Image class. Weird workarounds are great for a short term solution but as an open source project we should probably think about longevity. Using a workaround instead of fixing the problem itself just doesn’t sound like the best option in the long run.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<p>Compressed formats are good because <code>Image</code> already offers limited support for it.<br/>
For “normal” images <code>Image</code> offers a lot of utility functions that have to be refactored or extended.</p>
<p>These ones will require separate implementation for each image component type:</p>
<ul>
<li><code>Image::SetPixelInt</code></li>
<li><code>Image::Resize</code></li>
<li><code>Image::ClearInt</code></li>
<li><code>Image::GetPixel</code></li>
<li><code>Image::GetPixelInt</code></li>
<li><code>Image::GetNextLevel</code></li>
<li><code>Image::ConvertToRGBA</code></li>
</ul>
<p>And I’m not really sure how to make some functions work for generic pixel type.<br/>
I mean, how <code>GetPixelInt</code> is even supposed to work for float texture? Probably we want error message in these cases.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">SirNate0</div>
          <div class="post_content">
<p>Not having looked at where GetPixelInt and similar are used, my intuition is that it should actually return the same thing that the function <code>Color::ToUInt()</code> even if it’s a floating point texture just as GetPixel returns a floating point representation of the color.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">SirNate0</div>
          <div class="post_content">
<p>We would also need to add the necessary formats to the Graphics class. I think my preference would be to add an argument to the functions:</p>
<pre><code class="lang-auto">unsigned GetRGBAFormat();
</code></pre>
<p>would become</p>
<pre><code class="lang-auto">enum GRAPHICS_NUMBER_FORMAT {
    GNF_INT8=0,
    GNF_FLOAT16,
    GNF_FLOAT32
}

...

unsigned GetRGBAFormat(GRAPHICS_NUMBER_FORMAT fmt = GNF_INT8);
</code></pre>
<p>so that the switch statements on the number of components can be updated just by adding an image-&gt;GetNumberFormat() or the like to the calls. Though that switch statement to get the graphics format for the image could also be moved from the 4 texture kind implementations to the Texture or Image or Graphics classes.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1669_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GoldenThumbs</div>
          <div class="post_content">
<p>I like that idea. Has anyone actually started working on this yet? We should probably also open an issue on GitHub.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>well this is a step in the right direction.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3220_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">JSandusky</div>
          <div class="post_content">
<p><span class="mention">@GodMan</span> yea, pretty much. It’d probably be for the best if someone stripped most of the existing PBR out and replaced it with a port of Google’s Filament. Back then Filament didn’t exist, I’d probably have just ported it over if it had … hell, IIRC Lux was the only permissively licensed reference available at the time.</p>
<hr/>
<p>I mashed 2 things together at once when I said all that. The first being perf and the second being the very common <em>"It’s not only slow, but it also looks off</em>" … headaches with higher-precision textures is a big part of why things look off as well as the stupid decision to use the mobile env-approx on PC instead of split-sum.</p>
<p>RGBA16 (unorm) read is the only thing that’s needed for getting things looking right, writing it only matters if implementing filtering Urho3D side, assuming you want to save them and not just render them as needed. See <a href="https://github.com/***/***/pull/203" rel="nofollow noopener">https://github.com/***/***/pull/203</a> regarding OGL + D3D11 compute and cubemap filtering.</p>
<p>Read support for RGBA16 in Image.cpp for DDS is pretty much just adding <code>ddsd.ddpfPixelFormat_.dwRGBBitCount_ == 64</code> and <code>CF_RGBA16</code>, CF_RGBA16 doesn’t have to do the last conversion step (that mentions RGB565) - now you can load CMFT RGBA16 cubemaps.</p>
<pre><code class="lang-auto">if (ddsd.ddpfPixelFormat_.dwRGBBitCount_ != 64 &amp;&amp; ddsd.ddpfPixelFormat_.dwRGBBitCount_ != 32 &amp;&amp; 
    ddsd.ddpfPixelFormat_.dwRGBBitCount_ != 24 &amp;&amp; ddsd.ddpfPixelFormat_.dwRGBBitCount_ != 16)
{
    URHO3D_LOGERROR("Unsupported DDS pixel byte size");
    return false;
}
if (ddsd.ddpfPixelFormat_.dwRGBBitCount_ == 64)
    compressedFormat_ = CF_RGBA16;
else
    compressedFormat_ = CF_RGBA;
components_ = 4;
break;

... a little further down ...

// Calculate the size of the data
unsigned dataSize = 0;
if (compressedFormat_ != CF_RGBA &amp;&amp; compressedFormat_ != CF_RGBA16)
</code></pre>
<p>update <code>Graphics::GetFormat</code> to map CF_RGBA16 to DXGI_FORMAT_R16G16B16A16_UNORM and GL_RGBA16</p>
<p>But yes, more format support is a godsend since BC4 and BC5 are pretty much purpose built for PBR (and normals).</p>
<hr/>
<p><strong>Back to perf:</strong></p>
<p>Scrap what’s there, port to Filament.</p>
<p>Low hanging fruit is to rework <code>View</code> to support packing up to N pure analytic point+spot lights found in the frustum into a cbuffer that a <code>scenepass</code> can receive (<code>use_analytic_lights="true"</code> or w/e). The pass can then march through N lights in one go instead of multipassing it. Obviously those analytic lights have to be ignored if any pass asked for analytic lights.</p>
<p>That’ll save a lot of redundancy while chewing through fill-lights, though it realistically caps out at 16-64 lights depending on your desired cap - no different than tiled-shading with 1-giant-tile.</p>
<p>I used this for my clustered-shading to decide whether the light goes in the cluster grid or is multi-passed:</p>
<pre><code class="lang-auto">bool Light::IsAnalytic() const
{
    if (auto renderer = GetSubsystem&lt;Renderer&gt;())
    {
        // must use defaults, which we can reproduce with math in the shader
        // I don't want to bother with managing texture arrays and their mappings
        if (renderer-&gt;GetDefaultLightRamp() != rampTexture_ ||
            renderer-&gt;GetDefaultLightSpot() != shapeTexture_)
            return false;
    }

    // Although analytic it doesn't make sense for a directional light to not cast-shadows except
    // in some really odd situations (non-photoreal)
    if (lightType_ == LIGHT_DIRECTIONAL)
        return false;

    // Must not cast shadows to be analytic ... because shadows aren't atlased
    return !GetCastShadows();
}
</code></pre>
<p>Atlasing shadowmaps opens up more modern options but it turns View into even more of a mess.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/902_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Eugene</div>
          <div class="post_content">
<aside class="quote no-group" data-post="23" data-topic="6271" data-username="JSandusky">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/21d4babb39f9f7d59fc4987dd1566385.png" width="20"/> JSandusky:</div>
<blockquote>
<p>Low hanging fruit is to rework <code>View</code></p>
</blockquote>
</aside>
<p><s>Phrases “rework View” and “low hanging fruit” cannot coexist in the same sentence.</s><br/>
I have tried to add stuff into View three times and I have failed miserably in two of there attempts. Did you have any success in implementing your suggestion? I mean, I know it’s possible to do if you need just this once scenario to work. However, is it possible to do without messing up any of existing use cases of View? Every time I’m trying to work inside View, I have to deal with hundreds of supported tiny features that tend to break off when I push too hard.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3220_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">JSandusky</div>
          <div class="post_content">
<p>Previous View guttings:</p>
<ul>
<li>Clustered shading</li>
<li>Zone texture mixing (octahedral maps instead of cubes)</li>
<li>Ditching the stored forward and deferred light passes</li>
<li>Some compute for GPU culling</li>
<li>Single-pass stereo</li>
</ul>
<p>It’s at most 2 hours of work, even less if hacked into  <code>CheckVisibilityWork(...)</code> and stored in a seperate “AnalyticLights” list in <code>PerThreadSceneResult</code> while ignored from the other. The rest of it is setting a shader-define (HAS_ANALYTIC_LIGHTS or w/e) and shader-constants.</p>
<p>Done more correctly a blob of analytic lights pretty much just follows along the existing vertex-lights doing nothing remarkable that isn’t already done. The only real wierdness is if there’s a need for analytic lights to also be included as regular lights in some other lighting pass … that might get weird.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>I have no idea what you guys are talking about <img alt=":rofl:" class="emoji" src="../../../images2/b8e55af518619a978b88eeaeaca19aa3.png" title=":rofl:"/><img alt=":rofl:" class="emoji" src="../../../images2/b8e55af518619a978b88eeaeaca19aa3.png" title=":rofl:"/>.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>Does anyone have any screenshots of PBR in a game setting with urho3d?</p>
<p>Just curious of the results.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<aside class="quote quote-modified" data-post="220" data-topic="2431">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" loading="lazy" src="../../../images2/5f7f7fed83ed7d9a4f9af8cfe3c29eee.png" width="20"/>
<a href="https://discourse.urho3d.io/t/random-projects-shots/2431/220">Random projects shots</a> <a class="badge-wrapper bullet" href="/c/showcase/projects/12"><span class="badge-category-parent-bg" style="background-color: #F1592A;"></span><span class="badge-category-bg" style="background-color: #808281;"></span><span class="badge-category clear-badge" data-drop-close="true" style="" title="Announcements and news updates to your projects using Urho3D.">Projects</span></a>
</div>
<blockquote>
    Latest screenshot from my game 
 <a class="lightbox"   rel="noopener nofollow ugc" title="Screen Shot 2020-07-17 at 1.17.06">[Screen Shot 2020-07-17 at 1.17.06]</a> 
Urho can provide good graphics by GPU gets very hot with pbr and ssao. 
Scene and assets was exported from Unity using Gleb’s exporter <a href="https://github.com/gleblebedev/Unity2Urho" rel="noopener nofollow ugc">https://github.com/gleblebedev/Unity2Urho</a> - building scenes in Unity3D and exporting it into Urho seems to me the only reliable and convenient flow right now. 
Water was also exported in the same way 
           

If you are interested - you can track project progress here <a href="https://discord.gg/***" rel="noopener nofollow ugc">https://discord.gg/jV…</a>
</blockquote>
</aside>

          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>looks like forward rendering without PBR.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Well, it’s forward rendering with pbr shaders…</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>What exactly are you looking for? My unity 2 urho exporter converts unity pbr setup into urho pbr so I can easily make a sample scene to demonstrate Urho3D pbr capabilities.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2369_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Dave82</div>
          <div class="post_content">
<p>I think what he was trying to say is that the scene doesn’t look pbr-ish. The materials are very bland. They look like a simple Diff.xml technique. I don’t think it’s worth overheating your GPU for results like this. You can achieve similar results with a simple DiffNormalSpec technique with no impact on GPU. Also the SSAO is not very noticable.</p>
<p>Maybe you could make a scene with more metal and stone materials to have more reflections and specular mapping</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>I have little experience with PBR, but it seems to me like HDRIs would be a requirement for realistic results. Use of normal-range images could explain the bland lighting.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1669_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GoldenThumbs</div>
          <div class="post_content">
<p>Yeah, we have been talking about adding support for loading HDR image formats. Like, currently <a href="https://en.wikipedia.org/wiki/RGBE_image_format" rel="nofollow noopener">Radiance HDR images</a> can be loaded in Urho (thanks to stb_image) but are loaded loaded as rgba8 due to how the image loading functions work.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>The ability to use resources straight from <a href="https://hdrihaven.com/hdris/">HDRI Haven</a> would be logicool. <img alt=":sunglasses:" class="emoji" src="../../../images2/b0f1d61a7e5d86e44b16b3121703744a.png" title=":sunglasses:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>If you have an asset with such scene I can import it into Urho. A gltf from sketchfab or a link to free Unity asset will suffice.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>I’ve imported a HDRI Haven sky previously into Urho using spehere mesh and skydome shader… Is there anything else to it beside internal 8 bit rgb representation?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<aside class="quote no-group" data-post="37" data-topic="6271" data-username="glebedev">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/90a2a92f43373de28e30545cf263b19a.png" width="20"/> glebedev:</div>
<blockquote>
<p>Is there anything else to it beside internal 8 bit rgb representation?</p>
</blockquote>
</aside>
<p>Maybe not. <img alt=":upside_down_face:" class="emoji" src="../../../images2/3b8b240735a088b5bc2206c3a5672679.png" title=":upside_down_face:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p><div class="lightbox-wrapper"><a class="lightbox"   rel="nofollow noopener" title="image"><img alt="image" data-base62-sha1="zXhSqE1R47jIVzOjsvgp3CXZh9k"  height="393" src="../../../images2/2e1c6eda304d610303332290d9e46cbc.jpeg"  width="690"/><div class="meta"><svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1621×924 671 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2836_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">extobias</div>
          <div class="post_content">
<p>That looks gorgeous!<br/>
Any chance of a video?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>I’m not sure if a video is better than a screenshot in this case…<br/>
<iframe frameborder="0" height="359" sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-presentation" scrolling="no" seamless="seamless" src="https://gyazo.com/player/fcfb29d8e4cba6041703ceefa1bd4e34" width="695"></iframe>
</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>Yeah that looks alot better. Is that all PBR shaders?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>Yep. I’ve added support for HDRP/Lit shader. The scene is supplied in HDRP setup. I’ve switched off all light sources but directional (sun) and added fog similar to the original scene.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1669_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GoldenThumbs</div>
          <div class="post_content">
<p>Not really internally, it’s more just how the image is loaded by the engine. RGBE images have use the E channel as an exponent for a given pixel so you can get high dynamic range without needing higher precision. I’d have to look at the internal workings of both stb_image and the image class but I don’t think that the texture you wind up getting in Urho3D is HDR. The image class doesn’t support that. I’ll give an update after I check.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2369_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Dave82</div>
          <div class="post_content">
<p>I think PBR rendering is already past… Just saw the UDK 5 demo and i was completely blown away. This technology is just ublievable ! No normal maps , no baked lights no specular maps no worries about poly count just focus on creativity and art ! Also the extreme procedural intelligent animation system will save enormous time so you don’t need to waste time on hunting/cleaning mocap files. I hope new open source engines will be based on this sort of technology…</p>
<div class="onebox lazyYT lazyYT-container" data-parameters="feature=oembed&amp;wmode=opaque" data-youtube-id="qC5KtatMcUw" data-youtube-title="Unreal Engine 5 Revealed! | Next-Gen Real-Time Demo Running on PlayStation 5">
<a href="https://www.youtube.com/watch?v=qC5KtatMcUw" rel="nofollow noopener" target="_blank">
<img class="ytp-thumbnail-image" height="388" src="../../../images2/2ea960ce9b233a624701c5ddbb6eaa32.jpg" title="Unreal Engine 5 Revealed! | Next-Gen Real-Time Demo Running on PlayStation 5" width="690"/>
</a>
</div>

          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3871_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">glebedev</div>
          <div class="post_content">
<p>I’m quite sure PBR is still there. Also the “Nanite” tech isn’t for characters.</p>
<p>Procedural animation… What Urho needs is a IK character setup (at least similar to Unity) to do this: <a href="https://www.youtube.com/watch?v=KLjTU0yKS00" rel="nofollow noopener">https://www.youtube.com/watch?v=KLjTU0yKS00</a></p>
<p>At least this way you won’t need a set of animations for bipedal characters as it could be calculated in runtime.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1669_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GoldenThumbs</div>
          <div class="post_content">
<p>It’s amazing tech, but some of their claims are a tad misleading. They actually still use normalmaps in quite a few of those assets, but they are more just scratches and stuff, super small detail that’s harder to be carried by geometry even if it’s a super dense mesh. Pretty sure they are still use gloss/roughness maps because they aren’t simulating light bounces at a microscopic level. I think Urho could really benefit from some form of realtime bounced lighting, but that’s not exactly something that most indie devs will need. Most people are totally fine with baked GI. (that being said, Godot is getting a neat new RT GI in addition to updates to their existing system.)<br/>
I really think there needs to be a good look and evaluate some of the more basic aspects of the renderer. The already mentioned HDR texture loading is an issue, I think I saw someone mention the possibility of clustered lighting. I see a lot of people complain about the current Urho UI, perhaps we can evaluate the idea of either overhauling or replacing the UI functionality.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2367_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jmiller</div>
          <div class="post_content">
<p>12 posts were split to a new topic: <a href="/t/ui-discussion/6338">UI - discussion</a></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1669_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GoldenThumbs</div>
          <div class="post_content">
<p>Forgot to give an update on this. stb_image converts radiance images to HDR automatically, which means that once you actually get the image in Urho it’s still LDR <em>and</em> you don’t even have access to the E channel to do the HDR conversion manually in a shader.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>