<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Script dockerized error on linux mint</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Script dockerized error on linux mint</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Hello,</p>
<p>I’m trying docker for first time, but it is not working for me (via script):</p>
<p>mcnito@mcnito-MINT01:~/Urho3D$ sudo script/dockerized.sh linux rake build install<br/>
groupadd: GID ‘0’ already exists<br/>
runuser: user urho3d does not exist</p>
<p>Any help?</p>
<p>Thanks!</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>Follow the instructions on the new website page. You should not use “sudo” at all.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<aside class="quote no-group" data-post="1" data-topic="6935" data-username="mcnito">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/e46ea19c5f93ec4b9e14ee99a231507c.png" width="20"/> mcnito:</div>
<blockquote>
<p>script/dockerized.sh linux rake build install</p>
</blockquote>
</aside>
<p>Without sudo:</p>
<p>mcnito@mcnito-MINT01:/media/mcnito/LINUX_DATA/Urho3D$ script/dockerized.sh linux rake build install<br/>
Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.24/version: dial unix /var/run/docker.sock: connect: permission denied<br/>
docker: Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Post http://%2Fvar%2Frun%2Fdocker.sock/v1.24/containers/create: dial unix /var/run/docker.sock: connect: permission denied.<br/>
See ‘docker run --help’.</p>
<p>I’m following this instructions: <a class="inline-onebox" href="https://urho3d.io/docs/getting-started/quick-start" rel="noopener nofollow ugc">Quick Start | Urho3D</a></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>Use “podman” which is daemonless or complete the post installation step when continue to use “Docker Engine”. <a class="inline-onebox" href="https://docs.docker.com/engine/install/linux-postinstall/">Post-installation steps for Linux | Docker Documentation</a></p>
<p>Either way you should test run your setup with a simple Docker image before heading back to use the DBE images.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Thanks a lot!</p>
<p>Completing the post installation step worked for me.</p>
<p>I will take a look at podman anyway.</p>
<p>Thanks again.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Hi,</p>
<p>It’s me again…</p>
<p>It worked perfect for linux and web, but on Android its failing:</p>
<p>Starting a Gradle Daemon (subsequent builds will be faster)</p>
<p>FAILURE: Build failed with an exception.</p>
<ul>
<li>What went wrong:<br/>
A problem occurred configuring project ‘:android:launcher-app’.</li>
</ul>
<blockquote>
<p>Failed to notify project evaluation listener.<br/>
java.io.FileNotFoundException: /media/mcnito/LINUX_DATA/Urho3D/android/launcher-app/.cxx/ndk_locator_record_4t6d141t.log (No such file or directory)<br/>
Task with name ‘externalNativeBuildDebug’ not found in project ‘:android:launcher-app’.</p>
</blockquote>
<ul>
<li>
<p>Try:<br/>
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.</p>
</li>
<li>
<p>Get more help at <a href="https://help.gradle.org" rel="noopener nofollow ugc">https://help.gradle.org</a></p>
</li>
</ul>
<p>BUILD FAILED in 2m 3s</p>
<p>Any help?</p>
<p>Thanks <img alt=":slight_smile:" class="emoji" src="../../../images2/480f97b912eb537e18032299081e582a.png" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>Is your Urho3D project root mounted from somewhere else? If so, make sure you have write permission on the “/media/…”. The difference between Android build and other builds is that Android grade plug-in writes all over the places in the project root dir, while the rest just writes into “build/“ relative to the project root.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Thanks a lot again.</p>
<p>I ran script from /home (I will check permisisons later) and it worked (well, bypassed the step).</p>
<p>Now Im getting this error:</p>
<blockquote>
<p>Task :android:launcher-app:externalNativeBuildDebug FAILED<br/>
Build Urho3DPlayer_armeabi-v7a<br/>
ninja: Entering directory `/home/mcnito/Urho3D/android/launcher-app/.cxx/cmake/debug/armeabi-v7a’<br/>
ninja: error: ‘/home/mcnito/Urho3D/android/urho3d-lib/.cxx/cmake/debug/armeabi-v7a/lib/libUrho3D.so’, needed by ‘…/…/…/…/build/intermediates/cmake/debug/obj/armeabi-v7a/libUrho3DPlayer.so’, missing and no known rule to make it</p>
</blockquote>
<p>FAILURE: Build failed with an exception.</p>
<ul>
<li>What went wrong:<br/>
Execution failed for task ‘:android:launcher-app:externalNativeBuildDebug’.</li>
</ul>
<blockquote>
<p>Build command failed.<br/>
Error while executing process ninja with arguments {-C /home/mcnito/Urho3D/android/launcher-app/.cxx/cmake/debug/armeabi-v7a Urho3DPlayer}<br/>
ninja: Entering directory `/home/mcnito/Urho3D/android/launcher-app/.cxx/cmake/debug/armeabi-v7a’</p>
</blockquote>
<p>ninja: error: ‘/home/mcnito/Urho3D/android/urho3d-lib/.cxx/cmake/debug/armeabi-v7a/lib/libUrho3D.so’, needed by ‘…/…/…/…/build/intermediates/cmake/debug/obj/armeabi-v7a/libUrho3DPlayer.so’, missing and no known rule to make it</p>
<p>Sorry for asking that much, I feel I’m close to the end…</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>You didn’t say how you ended up in such situation, so it is difficult to pinpoint the exact step that lead to such error. But based on the log, I think the Gradle build process believed it has built the Urho3D library targets and then proceeded to build other dependent targets. They failed because the dependency library was in fact not found. So, I believe your Android build tree is in an inconsistent state. To recover, you could try:</p>
<pre><code class="lang-auto">script/dockerized.sh android ./gradlew cleanAll
</code></pre>
<p>After that, redo the <code>rake build install</code> using DBE. If the above Gradle “cleanAll” task also gave you error then you will have to clean all the directories generated by Android Gradle plugin yourself. Look for those dir with “.cxx” and “build” using <code>find</code> command and nuke them. Good luck.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Hi,</p>
<p>This not worked. I’ve even tried in a clean Linux Mint installation, with the following commands:</p>
<pre><code class="lang-auto">git clone https://github.com/urho3d/Urho3D.git
cd Urho3D
script/dockerized.sh android rake build install
</code></pre>
<p>And I still get the same error:</p>
<blockquote>
<p>Starting a Gradle Daemon, 1 incompatible and 1 stopped Daemons could not be reused, use --status for details</p>
</blockquote>
<p>…</p>
<blockquote>
<p>Task :android:launcher-app:externalNativeBuildDebug FAILED<br/>
Build Urho3DPlayer_armeabi-v7a<br/>
ninja: Entering directory `/home/mcnito/Urho3D/android/launcher-app/.cxx/cmake/debug/armeabi-v7a’<br/>
ninja: error: ‘/home/mcnito/Urho3D/android/urho3d-lib/.cxx/cmake/debug/armeabi-v7a/lib/libUrho3D.so’, needed by ‘…/…/…/…/build/intermediates/cmake/debug/obj/armeabi-v7a/libUrho3DPlayer.so’, missing and no known rule to make it</p>
</blockquote>
<p>FAILURE: Build failed with an exception.</p>
<ul>
<li>What went wrong:<br/>
Execution failed for task ‘:android:launcher-app:externalNativeBuildDebug’.</li>
</ul>
<blockquote>
<p>Build command failed.<br/>
Error while executing process ninja with arguments {-C /home/mcnito/Urho3D/android/launcher-app/.cxx/cmake/debug/armeabi-v7a Urho3DPlayer}<br/>
ninja: Entering directory `/home/mcnito/Urho3D/android/launcher-app/.cxx/cmake/debug/armeabi-v7a’</p>
</blockquote>
<p>ninja: error: ‘/home/mcnito/Urho3D/android/urho3d-lib/.cxx/cmake/debug/armeabi-v7a/lib/libUrho3D.so’, needed by ‘…/…/…/…/build/intermediates/cmake/debug/obj/armeabi-v7a/libUrho3DPlayer.so’, missing and no known rule to make it</p>
<ul>
<li>
<p>Try:<br/>
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.</p>
</li>
<li>
<p>Get more help at <a href="https://help.gradle.org" rel="noopener nofollow ugc">https://help.gradle.org</a></p>
</li>
</ul>
<p>Deprecated Gradle features were used in this build, making it incompatible with Gradle 7.0.<br/>
Use ‘–warning-mode all’ to show the individual deprecation warnings.<br/>
See <a class="inline-onebox" href="https://docs.gradle.org/6.7/userguide/command_line_interface.html#sec:command_line_warnings" rel="noopener nofollow ugc">Command-Line Interface</a></p>
<p>BUILD FAILED in 12m 26s<br/>
40 actionable tasks: 40 executed</p>
<p><strong>My question is:</strong></p>
<p>Should I try podman?<br/>
Should I try on any other Linux Distro?</p>
<p>Thanks!</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>The same Android DBE image is being downloaded and used over and over again without issue so far. As I understood on how the container technology works, I believe the host operating system has no bearing on your issue. Locally I use “podman” but our CI uses “Docker Engine”, so again you can rule this one out. From the experience I also know that once a docker image is good to run then it would run equally well everywhere. The only thing that I think your host machine could fail the Android build is the amount of memory it has. Since you didn’t paste the whole log, could it be possible that it actually had failed earlier on when building the library target?</p>
<p>You need to have at least 16 GB of memory or more. If you don’t have that many memory in your host then you could scale the Gradle build system down to only build for a single Android ABI at a time, instead of all 4 ABIs in one go (x86, x86_64, armeabi-v7a, and arm64-v8a). You can specify the ABI by using the <code>ANDROID_ABI</code> gradle property like so:</p>
<pre><code class="lang-auto">script/dockerized.sh android ./gradlew -P ANDROID_ABI=armeabi-v7a build publishToMavenLocal
</code></pre>
<p>You can also tell Gradle to build the target separately.</p>
<pre><code class="lang-auto">script/dockerized.sh android ./gradlew :android:urho3d-lib:build
</code></pre>
<p>This would just build the Urho3D library alone. So, you can see more easily if it builds OK or not.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Thanks for your help and for being so kind.</p>
<p>I’ve tried this on clean urho3d folder:</p>
<blockquote>
<p>script/dockerized.sh android ./gradlew :android:urho3d-lib:build</p>
</blockquote>
<p>And this is what i get:</p>
<p>FAILED: Source/Urho3D/CMakeFiles/Urho3D.dir/AngelScript/Generated_Classes.cpp.o<br/>
/usr/bin/ccache /android-sdk/ndk/21.3.6528147/toolchains/llvm/prebuilt/linux-x86_64/bin/clang++ --target=aarch64-none-linux-android21 --gcc-toolchain=/android-sdk/ndk/21.3.6528147/toolchains/llvm/prebuilt/linux-x86_64 --sysroot=/android-sdk/ndk/21.3.6528147/toolchains/llvm/prebuilt/linux-x86_64/sysroot  -DHAVE_SINCOSF -DHAVE_STDINT_H -DSTBI_NEON -DTOLUA_RELEASE -DURHO3D_ANGELSCRIPT -DURHO3D_FILEWATCHER -DURHO3D_IK -DURHO3D_IS_BUILDING -DURHO3D_LOGGING -DURHO3D_LUA -DURHO3D_NAVIGATION -DURHO3D_NETWORK -DURHO3D_PHYSICS -DURHO3D_PROFILING -DURHO3D_STATIC_DEFINE -DURHO3D_THREADING -DURHO3D_URHO2D -DURHO3D_WEBP -ISource/Urho3D -I…/…/…/…/…/…/Source/Urho3D -Iinclude/Urho3D/ThirdParty -Iinclude/Urho3D/ThirdParty/Bullet -Iinclude/Urho3D/ThirdParty/Detour -Iinclude/Urho3D/ThirdParty/LuaJIT -g -DANDROID -fdata-sections -ffunction-sections -funwind-tables -fstack-protector-strong -no-canonical-prefixes -D_FORTIFY_SOURCE=2 -Wformat -Werror=format-security   -Wno-invalid-offsetof -Qunused-arguments -fcolor-diagnostics -Wno-argument-outside-range -include “/home/mcnito/Urho3D/android/urho3d-lib/.cxx/cmake/release/arm64-v8a/Source/Urho3D/Precompiled.h” -Winvalid-pch -O2 -DNDEBUG  -fPIC -fvisibility=hidden -fvisibility-inlines-hidden   -std=c++11 -MD -MT Source/Urho3D/CMakeFiles/Urho3D.dir/AngelScript/Generated_Classes.cpp.o -MF Source/Urho3D/CMakeFiles/Urho3D.dir/AngelScript/Generated_Classes.cpp.o.d -o Source/Urho3D/CMakeFiles/Urho3D.dir/AngelScript/Generated_Classes.cpp.o -c …/…/…/…/…/…/Source/Urho3D/AngelScript/Generated_Classes.cpp<br/>
clang++: error: unable to execute command: Killed<br/>
clang++: error: clang frontend command failed due to signal (use -v to see invocation)<br/>
Android (6454773 based on r365631c2) clang version 9.0.8 (<a class="inline-onebox" href="https://android.googlesource.com/toolchain/llvm-project" rel="noopener nofollow ugc">toolchain/llvm-project - Git at Google</a> 98c855489587874b2a325e7a516b99d838599c6f) (based on LLVM 9.0.8svn)<br/>
Target: aarch64-none-linux-android21<br/>
Thread model: posix<br/>
InstalledDir: /android-sdk/ndk/21.3.6528147/toolchains/llvm/prebuilt/linux-x86_64/bin<br/>
clang++: note: diagnostic msg: PLEASE submit a bug report to <a class="inline-onebox" href="https://github.com/android-ndk/ndk/issues" rel="noopener nofollow ugc">Issues · android/ndk · GitHub</a> and include the crash backtrace, preprocessed source, and associated run script.<br/>
clang++: note: diagnostic msg:</p>
<hr/>
<p>PLEASE ATTACH THE FOLLOWING FILES TO THE BUG REPORT:<br/>
Preprocessed source(s) and associated run script(s) are located at:<br/>
clang++: note: diagnostic msg: /tmp/Generated_Classes-00e626.cpp<br/>
clang++: note: diagnostic msg: /tmp/Generated_Classes-00e626.sh<br/>
clang++: note: diagnostic msg:</p>
<hr/>
<p>ninja: build stopped: subcommand failed.</p>
<ul>
<li>
<p>Try:<br/>
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.</p>
</li>
<li>
<p>Get more help at <a href="https://help.gradle.org" rel="noopener nofollow ugc">https://help.gradle.org</a></p>
</li>
</ul>
<p>Deprecated Gradle features were used in this build, making it incompatible with Gradle 7.0.<br/>
Use ‘–warning-mode all’ to show the individual deprecation warnings.<br/>
See <a class="inline-onebox" href="https://docs.gradle.org/6.7/userguide/command_line_interface.html#sec:command_line_warnings" rel="noopener nofollow ugc">Command-Line Interface</a></p>
<p>BUILD FAILED in 21m 4s<br/>
16 actionable tasks: 16 executed</p>
<p>How can i get and share full log?</p>
<p>Thank you.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>Since you didn’t answer my question regarding the memory, I will assume your host has enough memory. You can try two things from here:</p>
<ol>
<li>Clear the build cache inside the docker volume in case earlier build attempts have produced bad cached objects. After that, retry the build install step again.</li>
</ol>
<pre><code class="lang-auto">script/dockerized.sh android ccache -Cz
</code></pre>
<ol start="2">
<li>Temporarily disable AngelScript subsystem by toggling off the <code>URHO3D_ANGELSCRIPT</code> build option.</li>
</ol>
<pre><code class="lang-auto">URHO3D_ANGELSCRIPT=0 script/dockerized.sh android
</code></pre>
<p>Unfortunately currently we have a known issue with the AngelScript subsystem in the master branch that it may produce generated source code with extra large object size when compiled. Still, if you indeed running into this issue then it may mean you actually don’t have enough memory and/or disk space.</p>
<p>Monitor your disk and memory usage while the DBE runs.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Hi again,</p>
<p>Sorry for not replying about the memory. My computer has only 8GB, but I’ve tried this:</p>
<blockquote>
<p>script/dockerized.sh android ./gradlew -P ANDROID_ABI=armeabi-v7a build publishToMavenLocal</p>
</blockquote>
<p>And gave the same error.</p>
<p>I have also tried this:</p>
<blockquote>
<p>script/dockerized.sh android ccache -Cz</p>
</blockquote>
<p>and this:</p>
<blockquote>
<p>URHO3D_ANGELSCRIPT=0 script/dockerized.sh android</p>
</blockquote>
<p>And still failed.</p>
<p>But…</p>
<p>I’ve tried this:</p>
<blockquote>
<p>URHO3D_ANGELSCRIPT=0 script/dockerized.sh android ./gradlew :android:urho3d-lib:build</p>
</blockquote>
<p>And worked!</p>
<p>But later I’ve tried this:</p>
<blockquote>
<p>URHO3D_ANGELSCRIPT=0 script/dockerized.sh android ./gradlew -P ANDROID_ABI=armeabi-v7a build publishToMavenLocal</p>
</blockquote>
<p>and this:</p>
<blockquote>
<p>URHO3D_ANGELSCRIPT=0 script/dockerized.sh android ./gradlew -P ANDROID_ABI=armeabi-v7a build publishToMavenLocal</p>
</blockquote>
<p>And both failed.</p>
<p>Error:</p>
<blockquote>
<p>Error while executing process ninja with arguments {-C /home/mcnito/Urho3D/android/launcher-app/.cxx/cmake/debug/armeabi-v7a Urho3DPlayer}<br/>
ninja: Entering directory `/home/mcnito/Urho3D/android/launcher-app/.cxx/cmake/debug/armeabi-v7a’</p>
<p>ninja: error: ‘/home/mcnito/Urho3D/android/urho3d-lib/.cxx/cmake/debug/armeabi-v7a/lib/libUrho3D.so’, needed by ‘…/…/…/…/build/intermediates/cmake/debug/obj/armeabi-v7a/libUrho3DPlayer.so’, missing and no known rule to make it</p>
</blockquote>
<p>So… does this confirm is a RAM problem? Extending swap partition should fix this?</p>
<p>Thanks, a lot, again <img alt=":slight_smile:" class="emoji" src="../../../images2/480f97b912eb537e18032299081e582a.png" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Added 16GB to swap and trying again</p>
<p><div class="lightbox-wrapper"><a class="lightbox"   rel="noopener nofollow ugc" title="image"><img alt="image" data-base62-sha1="m1y0fx9r8oyYDiF7AixHY81m3NP"  height="242" src="../../../images2/1c60b73ac248c7f807631ea8c4dacee8.png"  width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1307×459 70 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>I will tell results <img alt=":slight_smile:" class="emoji" src="../../../images2/480f97b912eb537e18032299081e582a.png" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Failed again, sure its my fault, but i dont know what to try <img alt=":pleading_face:" class="emoji" src="../../../images2/04a4f21021cb05b367c229cee33a9694.png" title=":pleading_face:"/></p>
<p><div class="lightbox-wrapper"><a class="lightbox"   rel="noopener nofollow ugc" title="image"><img alt="image" data-base62-sha1="iJyyi1MxvyQLieIjFRq6fhl2saB"  height="354" src="../../../images2/ccad289015e8c5e8fc2173099eaffdd9.png"  width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1477×759 108 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>Tomorrow will be another day…</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>No, this time it might be my fault forgetting to tell you to delete the old build tree first before flipping the “URHO3D_ANGELSCRIPT” build option. Having said that, I think 8 GB is too little for Android build.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Hi,</p>
<p>I’ve tried this:</p>
<blockquote>
<p>rm -r Urho3D/<br/>
git clone <a class="inline-onebox"  rel="noopener nofollow ugc">GitHub - urho3d/Urho3D: Cross-platform 2D and 3D game engine</a><br/>
cd Urho3D<br/>
script/dockerized.sh android ccache -Cz<br/>
URHO3D_ANGELSCRIPT=0 script/dockerized.sh android ./gradlew -P ANDROID_ABI=armeabi-v7a build publishToMavenLocal</p>
</blockquote>
<p>And… failed:</p>
<p><div class="lightbox-wrapper"><a class="lightbox"   rel="noopener nofollow ugc" title="image"><img alt="image" data-base62-sha1="yUMV9UPHav8tULpCBGufKfdFWGF"  height="210" src="../../../images2/a5d6d9e16e2223f287740fa69858904d.png"  width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1458×444 64 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>Maybe I can try any alternative, If I do an step back, my plan was…</p>
<ol>
<li>Get docker working for easily deploy to:</li>
</ol>
<p>a) linux, for developing → done<br/>
b) web, for sharing → done<br/>
c) android, for testing real perfomance on device → fail</p>
<ol start="2">
<li>
<p>Find a good IDE for developing and a fast way to test/compile again and again (I think I can make a script that builds linux via docker and runs it locally).</p>
</li>
<li>
<p>Integrate standard C++ libraries, like AdMob ( <a class="inline-onebox" href="https://firebase.google.com/docs/admob/cpp/quick-start" rel="noopener nofollow ugc">开始  |  Firebase</a> ).</p>
</li>
<li>
<p>Finally, also deploy it for iOS (I know I will have to do it via cmake way).</p>
</li>
</ol>
<p>So, I’m very close to step 2, where I will start to port an abandoned Away3D project.</p>
<p>I dont own a 16GB computer (I can buy RAM, if is the only solution).</p>
<p>Extending SWAP (to 16GB) did not helped.</p>
<p>Do you think that trying podman could help?</p>
<p>Maybe I have docker not installed correctly?</p>
<p>Thanks a lot, any advice would be apreciated.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>You just simply need more RAM.</p>
<p>I recall one of the user who got memory issue before reported that increasing the max heap size to 8 GB in the “gradle.properties” file helps. I haven’t verified that personally though. So, take the above advise with a grain of salt. I fixed memory issue with my Android build by putting more sticks into the machine <img alt=":grin:" class="emoji" src="../../../images2/ddd9238e0251258f0e7c75580500e321.png" title=":grin:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Hi <span class="mention">@weitjong</span> ,</p>
<p>Sorry for late reply, but until today I had no access to &gt;= 16GB RAM.</p>
<p>Today, a friend gave me RAM sticks and I’ve tried, in a clean Urho3D installation with 20GB RAM, and I get the same error:</p>
<p><div class="lightbox-wrapper"><a class="lightbox"   rel="noopener nofollow ugc" title="image"><img alt="image" data-base62-sha1="hOhi3sq1KkBXPjBDZGs1eltnbd1"  height="239" src="../../../images2/424a36b45a9bb4de2ef092377247c0be.png"  width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1311×455 66.6 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>If I try:</p>
<blockquote>
<p>URHO3D_LIB_TYPE=SHARED script/dockerized.sh android rake build install</p>
</blockquote>
<p>or</p>
<blockquote>
<p>URHO3D_LIB_TYPE=STATIC script/dockerized.sh android rake build install</p>
</blockquote>
<p>or</p>
<blockquote>
<p>URHO3D_ANGELSCRIPT=0 script/dockerized.sh android ./gradlew :android:urho3d-lib:build</p>
</blockquote>
<p>all of them work, but none of them allow me to build and .apk of my app, also no sample apks are build.</p>
<p>Any help would be appreciated. Im having a lot of fun with Urho3D and Im focused on web deployment now, but anyday I know I will want to make apks.</p>
<p>Thanks a lot.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">tarzeron</div>
          <div class="post_content">
<pre><code class="lang-auto">URHO3D_LIB_TYPE=SHARED script/dockerized.sh android rake build install
</code></pre>
<p>This command work on linux mint. On my system 64 GB RAM, but for build was used ~13GB. After first execute I get errors, and I just executed the same command without cleaning and second build was successfully.</p>
<p>Why you use dockerized script?</p>
<p>You can build without docker with this script and environment on linux mint:</p>
<pre><code class="lang-auto"># !/bin/sh 
export ANDROID_NDK=~/Android/Sdk/ndk/21.0.6113669
export ANDROID_SDK=~/Android/Sdk
export PATH=$ANDROID_NDK/toolchains/x86_64-4.9/prebuilt/linux-x86_64/bin:$ANDROID_NDK/build:$ANDROID_NDK/prebuilt/linux-x86_64/bin:$ANDROID_SDK/tools:$ANDROID_SDK/tools/bin:$ANDROID_SDK/platform-tools:$PATH

export URHO3D_HOME=~/workspace/Urho3D/android/urho3d-lib/build/outputs/aar

cd ./android

gradle wrapper --gradle-version 6.2 --distribution-type all
./gradlew Build

</code></pre>
<p><div class="lightbox-wrapper"><a class="lightbox"   rel="noopener nofollow ugc" title="Снимок экрана в 2021-12-11 17-08-10"><img alt="Снимок экрана в 2021-12-11 17-08-10" data-base62-sha1="dEdBNM0a7QMkIY8gV1awSaNvhQJ"  height="500" src="../../../images2/0d4db61a4ae42b3daf40ef8e2b6ec550.png"  width="630"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">Снимок экрана в 2021-12-11 17-08-10</span><span class="informations">1012×803 128 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div><br/>
<div class="lightbox-wrapper"><a class="lightbox"   rel="noopener nofollow ugc" title="Снимок экрана в 2021-12-11 17-08-05"><img alt="Снимок экрана в 2021-12-11 17-08-05" data-base62-sha1="sIwm1U7ibgbCL32mZyu1Ivue6j3"  height="500" src="../../../images2/7cd381f576b922a96d40b436c3f666d7.png"  width="630"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">Снимок экрана в 2021-12-11 17-08-05</span><span class="informations">1012×803 118 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mcnito</div>
          <div class="post_content">
<p>Hi,</p>
<p>Thank you for your help.</p>
<p>I’m trying to do EXACTLY as you do, but Im doing something different…:</p>
<p><img alt="image" data-base62-sha1="6ElISJI5sFyaZ2zMLJ8meuJ7aId" height="264" src="../../../images2/21d4875696715da8f431547f2f4910d3.png" width="661"/></p>
<p>I think only different thing could be Java version (btw If I use Gradle 6.4 I get other error).</p>
<p>Could you tell me your Java version please?</p>
<p><img alt="image" data-base62-sha1="m2BrT57iFJO1fjZPaZHPHj9AE2B" height="85" src="../../../images2/3e4c77ac0c82abdf0178457a4bd6cc99.png" width="618"/></p>
<p>Thanks a lot!</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">tarzeron</div>
          <div class="post_content">
<aside class="quote no-group" data-post="22" data-topic="6935" data-username="mcnito">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="../../../images2/e46ea19c5f93ec4b9e14ee99a231507c.png" width="20"/> mcnito:</div>
<blockquote>
<p>Could you tell me your Java version please?</p>
</blockquote>
</aside>
<pre><code class="lang-auto">java --version
openjdk 11.0.11 2021-04-20
OpenJDK Runtime Environment (build 11.0.11+9-Ubuntu-0ubuntu2.20.04)
OpenJDK 64-Bit Server VM (build 11.0.11+9-Ubuntu-0ubuntu2.20.04, mixed mode, sharing)
</code></pre>
<p>I use this commit, it works with the SDK and NDK versions that I have installed<br/>
<code>3c4a0a54894e2ff346aa9f869af4e856cd1cc3ca</code></p>
<p>The previous script is not what you need now, I use it to build my project. You need this script now, it will build the library and application with examples.</p>
<pre><code class="lang-auto"># !/bin/sh 
export ANDROID_NDK=~/Android/Sdk/ndk/21.0.6113669
export ANDROID_SDK=~/Android/Sdk
export PATH=$ANDROID_NDK/toolchains/x86_64-4.9/prebuilt/linux-x86_64/bin:$ANDROID_NDK/build:$ANDROID_NDK/prebuilt/linux-x86_64/bin:$ANDROID_SDK/tools:$ANDROID_SDK/tools/bin:$ANDROID_SDK/platform-tools:$PATH
gradle wrapper --gradle-version 6.2 --distribution-type all
./gradlew Build
</code></pre>
<p>To save disk space and speedup build you can set the target processor architecture in gradle.properties, for example:<br/>
<code>ANDROID_ABI=armeabi-v7a</code></p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>