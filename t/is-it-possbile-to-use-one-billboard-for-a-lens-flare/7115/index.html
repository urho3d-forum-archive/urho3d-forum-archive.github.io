<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Is it possbile to use one billboard for a lens flare?</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Is it possbile to use one billboard for a lens flare?</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>I need to create a single quad that faces the camera for a lens flare effect. All I see is just possibly billboards. Is it possible to use the billboard system for just one quad that is static and always faces the camera?</p>
<p>Not use it for an actual particle system.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>Yes, that’s perfectly possible. <img alt=":+1:" class="emoji" src="../../../images2/84b617feab2b5c92cf77dc676ce8f68e.png" title=":+1:"/></p>
<p>Besides, you might run into multiple bright light sources later. Maybe you could subclass the <code>BillboardSet</code> as a <code>LensFlareSet</code> to which you can add <code>Light</code>s (similar to adding <code>Node</code>s to a <code>StaticModelGroup</code>). This would be generalized for varying colours, brightness <em>and</em> light types while checking the visibility of each with a screen ray cast.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>Okay I’ll see what I can come up with.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>You could also use a <code>Sprite</code>, btw. The main difference being that it’s a <code>UIElement</code>.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>It’s not really for a lens flare. This is what halo calls them. I just need a quad that faces the camera like the particle system does.</p>
<p>I’m trying to make the sentinel lights.</p>
<p> <a class="onebox" href="https://i.pinimg.com/originals/1a/be/2b/1abe2b6aca20cc845061bd20e3670ddd.jpg" rel="noopener nofollow ugc" target="_blank">
<img height="388" src="../../../images2/cd765fb42fbfa8b4f1fa99b04d913590.jpg" width="690"/>
</a>
</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>That <em>is</em> what I think of when I hear the term “lens flare” in a game development context.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>okay. I’m gonna try this with the billboard system.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>Okay I got it. Thanks <span class="mention">@Modanung</span> . Going to add the other lights.</p>
<p><div class="lightbox-wrapper"><a class="lightbox"   rel="noopener nofollow ugc" title="Screenshot_Sun_Jan_02_18_14_00_2022"><img alt="Screenshot_Sun_Jan_02_18_14_00_2022" data-base62-sha1="hF8U8j969wLS28upB6y4jolytru"  height="291" src="../../../images2/00e1687ad8a22ffd1cf0ee5dd6811e5c.jpeg"  width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">Screenshot_Sun_Jan_02_18_14_00_2022</span><span class="informations">1920×810 142 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>If you’d like to get rid of the flare intersecting with the model - which I imagine you would - simply add <code>depthtest="always"</code> to the technique of the flare’s material.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>Fixed the flare colors to be more accurate. Added the depthtest to the technique.<br/>
<div class="lightbox-wrapper"><a class="lightbox"   rel="noopener nofollow ugc" title="Screenshot_Sun_Jan_02_19_44_11_2022"><img alt="Screenshot_Sun_Jan_02_19_44_11_2022" data-base62-sha1="gxmq4pN5nm4DYqtggNJzpRS8xxY"  height="291" src="../../../images2/54e6a4efe2662a27742522335dc5231c.jpeg"  width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">Screenshot_Sun_Jan_02_19_44_11_2022</span><span class="informations">1920×810 137 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">SirNate0</div>
          <div class="post_content">
<p>With the “always” setting for depth testing I think you’ll also need to make sure that it’s only visible when it should be, i.e. walls and such need to occlude it in software and/or you need to check whether the flare should be shown with a raycast to the center point or something. Otherwise I’m pretty sure you’ll see it through the walls even though the turret itself isn’t visible.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>Yeah I’m aware of this. I’ll have to think of a simple approach for this though.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>I’d do an octree raycast and then quickly fade the flare in or out - with a little scaling - using a <code>ValueAnimation</code>, when the visibility should change. You might want to disable occlusion to make sure the fade out finishes, preventing the flare from suddenly disappearing.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>I have no idea how to do the octree raycast.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>Have a look at the <code>Raycast</code> function from the Decals sample; 08.<br/>
Where you would of course replace <code>NormalizedScreenPos</code> with <code>WorldToScreenPos</code>. Apart from that change, you basically have your (in)visibility check right there. You might even do without the parameterization, use the distance from the light to the camera as <code>maxDistance</code> and disregard the hit position and drawable. Maybe send it just a <code>const Vector3&amp; worldPos</code>.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>I guess you would at least want to check the <code>Drawable</code>'s type to prevent other <code>BillboardSet</code>s (or the same) from hiding the flares. Which also means you’d need to use the <code>Octree</code>'s non-single raycast, as these may be the first hit drawable.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">GodMan</div>
          <div class="post_content">
<p>Great post <span class="mention">@Modanung</span> I will look into this when I get a chance.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>