<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Particle system not working on iOS</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Particle system not working on iOS</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jzpekarek</div>
          <div class="post_content">
<p>After upgrading (form version 1.5) to the latest master branch, I’m now having problems with the particle system on iOS. I currently build my application for both iOS and Windows. The particle system on Windows is working fine (see the picture below of the rocket flames implemented as a particle system).</p>
<p><div class="lightbox-wrapper"><a class="lightbox"   rel="nofollow noopener" title="image"><img alt="image" data-base62-sha1="ia6DRU47abAyINoDJRuHOF1p4NE"  height="500" src="../../../images2/27b4875796f42bdd003522f4cc8f8714.jpeg"  width="598"/><div class="meta"><svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1313×1097 764 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p>On iOS, the particles either draw much, much smaller as shown below.</p>
<p><div class="lightbox-wrapper"><a class="lightbox"   rel="nofollow noopener" title="image"><img alt="image" data-base62-sha1="ncs4G4CzxCmvE0l1uUFZVDYcs9u"  height="486" src="../../../images2/f3c5e8ec0b865ec38cfa3ff667b75483.jpeg" width="690"/><div class="meta"><svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">image</span><span class="informations">894×630 214 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p>Or when I change the angle of view, sometimes like below:<br/>
<div class="lightbox-wrapper"><a class="lightbox"   rel="nofollow noopener" title="image"><img alt="image" data-base62-sha1="bTDUp9uorlYQp25BGFjSUzpXzXX"  height="486" src="../../../images2/feb0ac0ac43a36e87bb4544fb9d87800.jpeg" width="690"/><div class="meta"><svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">image</span><span class="informations">894×630 188 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p>The particle file is shown below. Any ideas what might be wrong here (seems like a bug since it works on Windows, and used to work on iOS in version 1.5). EDIT - I went back to a 1.6 version that I built to help debug another regression on iOS, and found that the particle systems wasn’t working on iOS for my example in 1.6 either (so I’m assuming it is a regression from 1.5 to 1.6).</p>
<pre><code>&lt;?xml version="1.0"?&gt;
&lt;particleeffect&gt;
&lt;material name="Materials/Particle.xml" /&gt;
&lt;numparticles value="100" /&gt;
&lt;updateinvisible enable="false" /&gt;
&lt;relative enable="false" /&gt;
&lt;scaled enable="true" /&gt;
&lt;sorted enable="false" /&gt;
&lt;animlodbias value="0" /&gt;
&lt;emittertype value="Box" /&gt;
&lt;emittersize value="0.3 0 0" /&gt;
&lt;direction min="-0.1 0.5 -0.1" max="0.1 4 0.1" /&gt;
&lt;constantforce value="0 2 0" /&gt;
&lt;dampingforce value="1" /&gt;
&lt;activetime value="0" /&gt;
&lt;inactivetime value="0" /&gt;
&lt;emissionrate min="80" max="80" /&gt;
&lt;particlesize min="0.14 0.14" max="0.5 1" /&gt;
&lt;timetolive min="0.1" max="0.4" /&gt;
&lt;velocity min="6" max="8" /&gt;
&lt;rotation min="0" max="0" /&gt;
&lt;rotationspeed min="0" max="0" /&gt;
&lt;sizedelta add="0" mul="0.8" /&gt;
&lt;colorfade color="0.3 0.4 0.7 1" time="0" /&gt;
&lt;colorfade color="0.7 0.5 0.2 1" time="0.1" /&gt;
&lt;colorfade color="0 0 0 0" time="0.4" /&gt;
&lt;/particleeffect&gt;</code></pre>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3290_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Modanung</div>
          <div class="post_content">
<p>Seems like something worth opening an issue on GitHub for.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jzpekarek</div>
          <div class="post_content">
<p>Since I have both a Windows and iOS build that I work with, I’ll spend some time stepping through the code in both builds to see if I can figure out where the iOS build is going wrong.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jzpekarek</div>
          <div class="post_content">
<p>I figured out the problem, mostly operator error on my part. After stepping through the creation of the vertex buffers on both Windows and iOS, and finding that there was no difference, I realized that the main difference between the two is that they use different shaders. On the Windows build, I had updated to the newer shaders, but I apparently forgot to do the same thing for the iOS build, so I was using shader code from version 1.5 with the latest master version, and changes in the billboarding weren’t being handled correctly. Anyway, maybe this post will help someone else out that makes the same mistake!</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>