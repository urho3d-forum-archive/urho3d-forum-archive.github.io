<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Help! how to build urho3d with sample for android on mac osx?</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="Urho3D" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 17/01/2023.</div>
    <h1 class="topic-title">Help! how to build urho3d with sample for android on mac osx?</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3577_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">majhong</div>
          <div class="post_content">
<p>i use cmake with gui, it can not find a toolchain!</p>
<p>the flow is my step.<br/>
step1:<br/>
<img src="//cdck-file-uploads-global.s3.dualstack.us-west-2.amazonaws.com/standard17/uploads/urho3d/original/2X/9/9741d856e24203ac52662fb2aa9a97a4fb5107a2.jpeg"/><br/>
step2:<br/>
<img src="//cdck-file-uploads-global.s3.dualstack.us-west-2.amazonaws.com/standard17/uploads/urho3d/original/2X/3/35a64fc15fcadc083c9522621d0596fead92c8be.jpeg"/><br/>
step3: find path<br/>
<img src="//cdck-file-uploads-global.s3.dualstack.us-west-2.amazonaws.com/standard17/uploads/urho3d/original/2X/1/17938cc5efd61e03f4fe814b3f11b90f20c5ba09.jpeg"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3577_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">majhong</div>
          <div class="post_content">
<p>I switch ANDROID_TOOLCHAIN_NAME from arm-linux-androideabi-clang  to  arm-linux-androideabi-4.9<br/>
set path :   xxxxxx/toolchains/arm-linux-androideabi-4.9/prebuilt/darwin-x86_64/bin<br/>
xxxxxx is my ndk path!</p>
<p>the error is the same !</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>We have already migrated our Android build system to use Gradle in master branch. If you want to use release 1.7 tag then you have to use an old version of Android build tool. Search the forum for old threads with that subject.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3577_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">majhong</div>
          <div class="post_content">
<p>I get another error when i switch gradle .</p>
<p>step1: download  master branch (<a class="inline-onebox-loading"  rel="nofollow noopener">https://github.com/urho3d/Urho3D.git</a>)</p>
<p>step2:  ./gradlew build</p>
<p>step3: error --&gt;</p>
<p><img src="//cdck-file-uploads-global.s3.dualstack.us-west-2.amazonaws.com/standard17/uploads/urho3d/original/2X/9/96b400a2b12c8365c44d68dfdc62c076d0e7402b.jpeg"/></p>
<p>add --stacktrace<br/>
<img src="//cdck-file-uploads-global.s3.dualstack.us-west-2.amazonaws.com/standard17/uploads/urho3d/original/2X/4/469cd4acbeffb450b4d0d78a8ccd4b55e8ef4f69.jpeg"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>The error is already clearly stated. Read the HEAD version of the online doc for Android build.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3577_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">majhong</div>
          <div class="post_content">
<p>sorry! i am a newer of android studio.</p>
<p>i got a new error</p>
<p>FAILURE: Build failed with an exception.</p>
<ul>
<li>What went wrong:<br/>
Execution failed for task ‘:android:urho3d-lib:generateJsonModelDebug’.</li>
</ul>
<blockquote>
<p>Build command failed.<br/>
Error while executing process /Users/leeco/Library/Android/sdk/cmake/3.6.4111459/bin/cmake with arguments {-H/Users/leeco/game_dev/Urho3D-master -B/Users/leeco/game_dev/Urho3D-master/android/urho3d-lib/.externalNativeBuild/cmake/debug/armeabi-v7a -DANDROID_ABI=armeabi-v7a -DANDROID_PLATFORM=android-17 -DCMAKE_LIBRARY_OUTPUT_DIRECTORY=/Users/leeco/game_dev/Urho3D-master/android/urho3d-lib/build/intermediates/cmake/debug/obj/armeabi-v7a -DCMAKE_BUILD_TYPE=Debug -DANDROID_NDK=/Users/leeco/Library/Android/sdk/ndk-bundle -DCMAKE_TOOLCHAIN_FILE=/Users/leeco/Library/Android/sdk/ndk-bundle/build/cmake/android.toolchain.cmake -DCMAKE_MAKE_PROGRAM=/Users/leeco/Library/Android/sdk/cmake/3.6.4111459/bin/ninja -GAndroid Gradle - Ninja -DANDROID_CCACHE=/usr/local/opt/ccache/libexec -DGRADLE_BUILD_DIR=/Users/leeco/game_dev/Urho3D-master/android/urho3d-lib/build -DURHO3D_PLAYER=0 -DURHO3D_SAMPLES=0}<br/>
– Check for working C compiler: /Users/leeco/Library/Android/sdk/ndk-bundle/toolchains/llvm/prebuilt/darwin-x86_64/bin/clang<br/>
– Check for working C compiler: /Users/leeco/Library/Android/sdk/ndk-bundle/toolchains/llvm/prebuilt/darwin-x86_64/bin/clang – broken<br/>
CMake Error at /Users/leeco/Library/Android/sdk/cmake/3.6.4111459/share/cmake-3.6/Modules/CMakeTestCCompiler.cmake:61 (message):<br/>
The C compiler<br/>
“/Users/leeco/Library/Android/sdk/ndk-bundle/toolchains/llvm/prebuilt/darwin-x86_64/bin/clang”<br/>
is not able to compile a simple test program.</p>
</blockquote>
<pre><code>It fails with the following output:

 Change Dir: /Users/leeco/game_dev/Urho3D-master/android/urho3d-lib/.externalNativeBuild/cmake/debug/armeabi-v7a/CMakeFiles/CMakeTmp</code></pre>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>In this case you will probably need to start slow by following getting started guide from Android Developer website. You probably want to retry the build from scratch again. Remove the build tree and all the hidden dirs generated by Android plugin for Gradle.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3577_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">majhong</div>
          <div class="post_content">
<p>i got this error!</p>
<p>Users/leeco/game_dev/Urho3D-master/Source/ThirdParty/SDL/src/cpuinfo/SDL_cpuinfo.c:47:10: fatal error: ‘sys/sysctl.h’ file not found<br/>
<span class="hashtag">#include</span> &lt;sys/sysctl.h&gt;<br/>
^~~~~~~~~~~~~~<br/>
1 error generated.<br/>
ninja: build stopped: subcommand failed.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>Which version of the Android build tool are you using? These are the one we use in our CI build via docker.</p>
<pre><code class="lang-auto">ARG tool_url=https://dl.google.com/android/repository/sdk-tools-linux-4333796.zip
ARG tool_version=27.0.3
ARG cmake_version=3.6.4111459
</code></pre>
<p>Although the CI uses Linux host and not macOS, the Android build is really a cross-compiling build. So which host machine you use should not be relevant, well except for Windows host.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3577_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">majhong</div>
          <div class="post_content">
<p>i downloaded a new master-branch<br/>
i got a new error this time.<br/>
(first build)</p>
<p>In file included from /Users/leeco/game_dev/Model/Urho3D-master/Source/ThirdParty/Bullet/src/BulletCollision/BroadphaseCollision/btQuantizedBvh.h:31:<br/>
…/…/…/…/…/…/Source/ThirdParty/Bullet/src/LinearMath/btVector3.h:343:7: error: argument value 10880 is outside the valid range [0, 255] [-Wargument-outside-range]<br/>
y = bt_splat_ps(y, 0x80);<br/>
^~~~~~~~~~~~~~~~~~~~<br/>
…/…/…/…/…/…/Source/ThirdParty/Bullet/src/LinearMath/btVector3.h:47:32: note: expanded from macro ‘bt_splat_ps’<br/>
<span class="hashtag">#define</span> bt_splat_ps( _a, _i )  bt_pshufd_ps((_a), BT_SHUFFLE(_i,_i,_i,_i) )<br/>
^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br/>
…/…/…/…/…/…/Source/ThirdParty/Bullet/src/LinearMath/btVector3.h:45:35: note: expanded from macro ‘bt_pshufd_ps’<br/>
<span class="hashtag">#define</span> bt_pshufd_ps( _a, _mask ) _mm_shuffle_ps((_a), (_a), (_mask) )<br/>
^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br/>
/Users/leeco/Library/Android/sdk/ndk-bundle/toolchains/llvm/prebuilt/darwin-x86_64/lib64/clang/8.0.2/include/xmmintrin.h:2608:11: note: expanded from macro ‘_mm_shuffle_ps’<br/>
(__m128)__builtin_ia32_shufps((__v4sf)(__m128)(a), (__v4sf)(__m128)(b), <br/>
^<br/>
In file included from /Users/leeco/game_dev/Model/Urho3D-master/Source/ThirdParty/Bullet/src/BulletCollision/BroadphaseCollision/btQuantizedBvh.cpp:18:<br/>
In file included from …/…/…/…/…/…/Source/ThirdParty/Bullet/src/LinearMath/btAabbUtil2.h:20:<br/>
In file included from …/…/…/…/…/…/Source/ThirdParty/Bullet/src/LinearMath/btTransform.h:21:<br/>
…/…/…/…/…/…/Source/ThirdParty/Bullet/src/LinearMath/btMatrix3x3.h:882:17: error: argument value 10880 is outside the valid range [0, 255] [-Wargument-outside-range]<br/>
__m128 vk = bt_splat_ps(_mm_load_ss((float *)&amp;k), 0x80);<br/>
^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br/>
…/…/…/…/…/…/Source/ThirdParty/Bullet/src/LinearMath/btVector3.h:47:32: note: expanded from macro ‘bt_splat_ps’<br/>
<span class="hashtag">#define</span> bt_splat_ps( _a, _i )  bt_pshufd_ps((_a), BT_SHUFFLE(_i,_i,_i,_i) )<br/>
^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br/>
…/…/…/…/…/…/Source/ThirdParty/Bullet/src/LinearMath/btVector3.h:45:35: note: expanded from macro ‘bt_pshufd_ps’<br/>
<span class="hashtag">#define</span> bt_pshufd_ps( _a, _mask ) _mm_shuffle_ps((_a), (_a), (_mask) )<br/>
^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br/>
/Users/leeco/Library/Android/sdk/ndk-bundle/toolchains/llvm/prebuilt/darwin-x86_64/lib64/clang/8.0.2/include/xmmintrin.h:2608:11: note: expanded from macro ‘_mm_shuffle_ps’<br/>
(__m128)__builtin_ia32_shufps((__v4sf)(__m128)(a), (__v4sf)(__m128)(b), <br/>
^<br/>
2 errors generated.</p>
<p>sorry, i use gradlew firstly.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>Like I said previously, you probably would want to learn the basic first before trying to build Urho3D engine. Although we have done everything possible to make it build out of the box, it still requires certain level of competency (and luck) to get it done.</p>
<p>One thing I notice about your reported “compilation error” is that they change from one attempt to another. You last error is unexplainable too. There is no “10880” magic constant used anywhere in our code. So, probably you were just seeing things. Perhaps it was caused by insufficient memory to build all the Android ABI in one go, I really don’t know. However, you can try one thing. Try build one single ABI at a time, like so: <code>./gradlew -PANDROID_ABI=armeabi-v7a clean build</code>.</p>
<p>Good luck.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3577_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">majhong</div>
          <div class="post_content">
<p>thank you weitjong !<br/>
it worked on armeabi-v7a ,it is enought for me</p>
<p>i have a litter time for compiling a android demo .(my game has already run on mac osx,but i need illustrate it on a android mobilephone)</p>
<p>the urho3d is one of the best game engine for c/c++ programer,Thank you for your contribution！</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3577_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">majhong</div>
          <div class="post_content">
<p>My  suggestion for compilation：<br/>
splite it into two apart<br/>
one is cmake build for c/c++ (product  .a  and .so)<br/>
the other is a android stuido project for build a apk (it is a loader only)<br/>
in this way, it a flexible solution for both c/c++ and java/kotlin</p>
<p>i want only a game and i don’t need all of them( java/kotlin/gradlew/androidstuido…)</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>You still think in term of old Android build using CMake and Ant. The Gradle build with google provided Android plugin internally actually does just that, but all nicely wrapped into a “build” task. There are other tasks available too. You have seen “clean” task in action above, just to name another example. So, I don’t know what else needs to be improved.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2113_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">fnadalt</div>
          <div class="post_content">
<p>I had the same error when compiling for x86 and the solution I found was to add -Wno-argument-outside-range in UrhoCommon.cmake:</p>
<p>495: elseif (CMAKE_CXX_COMPILER_ID MATCHES Clang)<br/>
496:    set (CMAKE_CXX_FLAGS “${CMAKE_CXX_FLAGS} -std=c++11 -Wno-argument-outside-range”)</p>
<p>Compiled fine.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/4_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">weitjong</div>
          <div class="post_content">
<p>At one time I had carefully aligned all our compiler flags for our Android build to follow as close as possible the flags being set when using the Android ndk-build approach, but it has been a while now and I don’t know if anything has changed after that. Having said that, currently our Android-CI builds for all the ABIs (including the x86) are tested to go well without the extra compiler flag you mentioned above. I already explained that since Android-build itself is a cross-compiling build, it makes no difference to perform the build on any *nix host machine (including Mac OSX).</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>